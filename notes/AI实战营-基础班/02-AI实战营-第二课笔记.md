# OpenMMLab AIå®žæˆ˜è¥ ç¬¬äºŒè¯¾ç¬”è®°

---
![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230202115351337-523975146.jpg)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230203174116047-204135633.png)

[TOC]



# å›¾åƒåˆ†ç±»ä¸ŽåŸºç¡€è§†è§‰åŸºç¡€

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204081138716-1947593979.png)

# 1.å›¾åƒåˆ†ç±»é—®é¢˜

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204081127248-236486312.png)

> **å›¾åƒåˆ†ç±»**æ˜¯æ ¹æ®å„è‡ªåœ¨å›¾åƒä¿¡æ¯ä¸­æ‰€åæ˜ çš„ä¸åŒç‰¹å¾ï¼ŒæŠŠä¸åŒç±»åˆ«çš„ç›®æ ‡åŒºåˆ†å¼€æ¥çš„å›¾åƒå¤„ç†æ–¹æ³•ã€‚ å®ƒåˆ©ç”¨è®¡ç®—æœºå¯¹å›¾åƒè¿›è¡Œå®šé‡åˆ†æžï¼ŒæŠŠå›¾åƒæˆ–å›¾åƒä¸­çš„æ¯ä¸ªåƒå…ƒæˆ–åŒºåŸŸåˆ’å½’ä¸ºè‹¥å¹²ä¸ªç±»åˆ«ä¸­çš„æŸä¸€ç§ï¼Œä»¥ä»£æ›¿äººçš„è§†è§‰åˆ¤è¯»ã€‚ ç®€å•çš„è¯´å°±æ˜¯è¯†åˆ«ä¸€å¼ å›¾ä¸­æ˜¯å¦æ˜¯æŸç±»/çŠ¶æ€/åœºæ™¯ï¼Œé€‚åˆå›¾ä¸­ä¸»ä½“ç›¸å¯¹å•ä¸€çš„åœºæ™¯ï¼Œå°†ä¸‹å›¾è¯†åˆ«ä¸ºæ±½è½¦çš„å›¾ç‰‡ã€‚

## 1.1 é—®é¢˜çš„æ•°å­¦è¡¨ç¤º

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204081201747-1548118001.png)

> å›¾ç‰‡åˆ†ç±»é—®é¢˜å°±æ˜¯è¾¨è®¤è¾“å…¥çš„å›¾ç‰‡ç±»åˆ«çš„é—®é¢˜ï¼Œä¸”å›¾ç‰‡çš„ç±»åˆ«å±žäºŽäº‹å…ˆç»™å®šçš„ä¸€ä¸ªç±»åˆ«ç»„ä¸­ã€‚å°½ç®¡è¿™çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†è¿™æ˜¯è®¡ç®—æœºè§†è§‰çš„ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼Œä¸”æœ‰å¾ˆå¹¿æ³›çš„å®žé™…åº”ç”¨ã€‚å¹¶ä¸”ï¼Œæœ‰å¾ˆå¤šçš„è®¡ç®—æœºè§†è§‰çš„é—®é¢˜æœ€ç»ˆä¼šåŒ–ç®€ä¸ºå›¾ç‰‡åˆ†ç±»é—®é¢˜ã€‚
>
> ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾æœ‰ä¸€ä¸ªå›¾ç‰‡åˆ†ç±»æ¨¡åž‹ï¼Œå®ƒå¯¹äºŽè¾“å…¥çš„ä¸‰é€šé“çš„å›¾ç‰‡ä¼šé¢„æµ‹å…¶å±žäºŽå››ä¸ªæ ‡ç­¾ï¼ˆlabelï¼‰çš„æ¦‚çŽ‡ï¼ˆå››ä¸ªæ ‡ç­¾ä¸º catï¼Œ dogï¼Œhatï¼Œmugï¼‰ã€‚ä¸‹å›¾æ‰€ç¤ºçš„å›¾ç‰‡æ˜¯ä¸€å¼ 248åƒç´ å®½åº¦ï¼Œ400åƒç´ é«˜åº¦çš„å›¾ç‰‡ï¼Œå¹¶ä¸”æœ‰RGBä¸‰é€šé“ï¼Œé‚£ä¹ˆè¿™å¼ å›¾ç‰‡å¯ä»¥ç”¨(3 * 248 * 400 )ä¸ªæ•°å­—è¡¨ç¤ºï¼Œæ¯ä¸ªæ•°å­—èŒƒå›´ä»Ž 0åˆ°255ï¼Œæ¨¡åž‹çš„ä»»åŠ¡å°±æ˜¯æŽ¥å—è¿™äº›æ•°å­—ï¼Œç„¶åŽé¢„æµ‹å‡ºè¿™äº›æ•°å­—ä»£è¡¨çš„æ ‡ç­¾ï¼ˆlabelï¼‰ã€‚


## 1.2 è§†è§‰ä»»åŠ¡çš„éš¾ç‚¹

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204081410707-1692314667.png)

> å¯¹äºŽäººç±»æ¥è¯´çœ‹æ‡‚å›¾ç‰‡æ˜¯ä¸€ä»¶å¾ˆç®€å•çš„äº‹æƒ…ï¼Œä½†æ˜¯å¯¹äºŽæœºå™¨æ¥è¯´è¿™æ˜¯ä¸€ä¸ªéžå¸¸éš¾çš„äº‹æƒ…ï¼Œæ¯”å¦‚2ä¸ªå…¸åž‹çš„éš¾ç‚¹ï¼š
>
> - **ç‰¹å¾éš¾ä»¥æå–**
>
> åŒä¸€åªç‹—åœ¨ä¸åŒçš„è§’åº¦ï¼Œä¸åŒçš„å…‰çº¿ï¼Œä¸åŒçš„åŠ¨ä½œä¸‹ã€‚åƒç´ å·®å¼‚æ˜¯éžå¸¸å¤§çš„ã€‚å°±ç®—æ˜¯åŒä¸€å¼ ç…§ç‰‡ï¼Œæ—‹è½¬90åº¦åŽï¼Œå…¶åƒç´ å·®å¼‚ä¹Ÿéžå¸¸å¤§ï¼
>
> æ‰€ä»¥å›¾ç‰‡é‡Œçš„å†…å®¹ç›¸ä¼¼ç”šè‡³ç›¸åŒï¼Œä½†æ˜¯åœ¨åƒç´ å±‚é¢ï¼Œå…¶å˜åŒ–ä¼šéžå¸¸å¤§ã€‚è¿™å¯¹äºŽç‰¹å¾æå–æ˜¯ä¸€å¤§æŒ‘æˆ˜ã€‚
>
> - **éœ€è¦è®¡ç®—çš„æ•°æ®é‡å·¨å¤§**
>
> æ‰‹æœºä¸Šéšä¾¿æ‹ä¸€å¼ ç…§ç‰‡å°±æ˜¯1000*2000åƒç´ çš„ã€‚æ¯ä¸ªåƒç´  RGB 3ä¸ªå‚æ•°ï¼Œä¸€å…±æœ‰1000 X 2000 X 3=6,000,000ã€‚éšä¾¿ä¸€å¼ ç…§ç‰‡å°±è¦å¤„ç† 600ä¸‡ ä¸ªå‚æ•°ï¼Œå†ç®—ç®—çŽ°åœ¨è¶Šæ¥è¶Šæµè¡Œçš„ 4K è§†é¢‘ã€‚å°±çŸ¥é“è¿™ä¸ªè®¡ç®—é‡çº§æœ‰å¤šææ€–äº†ã€‚


### 1.2.1 è¶…è¶Šè§„åˆ™ï¼šè®©æœºå™¨ä»Žæ•°æ®ä¸­å­¦ä¹ 

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204081801798-100389123.png)

> **CNNè§£å†³äº†ä¸Šé¢çš„ä¸¤å¤§éš¾é¢˜**
> CNN å±žäºŽæ·±åº¦å­¦ä¹ çš„èŒƒç•´ï¼Œå®ƒå¾ˆå¥½çš„è§£å†³äº†ä¸Šé¢æ‰€è¯´çš„2å¤§éš¾ç‚¹ï¼š
>
> 1. CNN å¯ä»¥æœ‰æ•ˆçš„æå–å›¾åƒé‡Œçš„ç‰¹å¾
> 2. CNN å¯ä»¥å°†æµ·é‡çš„æ•°æ®ï¼ˆä¸å½±å“ç‰¹å¾æå–çš„å‰æä¸‹ï¼‰è¿›è¡Œæœ‰æ•ˆçš„é™ç»´ï¼Œå¤§å¤§å‡å°‘äº†å¯¹ç®—åŠ›çš„è¦æ±‚


### 1.2.2 æœºå™¨å­¦ä¹ çš„å±€é™

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204081915383-2100529203.png)

> - æœºå™¨å­¦ä¹ ç®—æ³•å–„äºŽå¤„ç†ä½Žç»´ã€åˆ†å¸ƒç›¸å¯¹ç®€å•çš„æ•°æ®
> - å¯¹äºŽç±»åˆ«ç‰¹å¾åˆ†å¸ƒæ¥è¯´ï¼ŒåŒç±»æ•°æ®ç‰¹å¾è·ç¦»è¿œï¼Œå¼‚ç±»è·ç¦»è¿‘ã€‚
> - å›¾åƒæ•°æ®åœ¨å‡ åä¸‡ç»´çš„ç©ºé—´ä¸­ä»¥å¤æ‚çš„æ–¹å¼â€œç¼ ç»•â€åœ¨ä¸€èµ·ï¼Œå¸¸è§„çš„æœºå™¨å­¦ä¹ ç®—æ³•éš¾ä»¥å¤„ç†è¿™ç§å¤æ‚æ•°æ®åˆ†å¸ƒã€‚


### 1.2.3 ä¼ ç»Ÿæ–¹æ³•ï¼šè®¾è®¡å›¾åƒç‰¹å¾

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204081929086-1139999709.png)

> åœ¨è®¡ç®—æœºè§†è§‰ç ”ç©¶å’Œç‰¹å¾å›¾åƒç‰¹å¾çš„æ—©æœŸé˜¶æ®µ(1990s-2000)ï¼Œ(æ•°åä¸‡ç»´)åŽŸå§‹å›¾åƒéœ€è¦ç»è¿‡äººå·¥è®¾è®¡çš„ç®—æ³•è¿›è¡Œç‰¹å¾æå–ä¸Žè®¡ç®—ï¼Œä»Žè€Œè½¬æ¢ä¸ºç‰¹å¾å‘é‡ï¼Œå†é€šè¿‡æœºå™¨å­¦ä¹ ç®—æ³•å¯¹ç‰¹å¾å‘é‡è¿›è¡Œåˆ†ç±»å¤„ç†ã€‚
>
> - è‡³ä»Šä¸ºæ­¢ç‰¹å¾æ²¡æœ‰ä¸‡èƒ½å’Œç²¾ç¡®çš„å®šä¹‰ã€‚ç‰¹å¾çš„ç²¾ç¡®å®šä¹‰å¾€å¾€ç”±é—®é¢˜æˆ–è€…åº”ç”¨ç±»åž‹å†³å®šã€‚**ç‰¹å¾**æ˜¯ä¸€ä¸ªæ•°å­—å›¾åƒä¸­â€œæœ‰è¶£â€çš„éƒ¨åˆ†ï¼Œå®ƒæ˜¯è®¸å¤šè®¡ç®—æœºå›¾åƒåˆ†æžç®—æ³•çš„èµ·ç‚¹ã€‚å› æ­¤ä¸€ä¸ªç®—æ³•æ˜¯å¦æˆåŠŸå¾€å¾€ç”±å®ƒä½¿ç”¨å’Œå®šä¹‰çš„ç‰¹å¾å†³å®šã€‚å› æ­¤ç‰¹å¾æ£€æµ‹æœ€é‡è¦çš„ä¸€ä¸ªç‰¹æ€§æ˜¯â€œå¯é‡å¤æ€§â€ï¼šåŒä¸€åœºæ™¯çš„ä¸åŒå›¾åƒæ‰€æå–çš„ç‰¹å¾åº”è¯¥æ˜¯ç›¸åŒçš„ã€‚
>
> - äººå·¥è®¾è®¡å›¾åƒç‰¹å¾æ£€æµ‹ä¸Žæå–ç®—æ³•æœ‰ï¼Œä»¥ä¸‹åˆ†ç±»ï¼š
>
>   - 1.è¾¹ç¼˜æ£€æµ‹
>
>   - 2.è§’æ£€æµ‹
>
>   - 3.åŒºåŸŸæ£€æµ‹
>
>   - 4.è„Šæ£€æµ‹
>
>     - å…¶ä¸­ç‰¹å¾æè¿°å­æœ‰ï¼šSIFTã€SURFã€GLOHã€HOG
>
> - **æ–¹å‘æ¢¯åº¦ç›´æ–¹å›¾**ï¼ˆ**è‹±èªžï¼šHistogram of oriented gradient**ï¼Œç®€ç§°**HOG**ï¼‰æ˜¯åº”ç”¨åœ¨è®¡ç®—æœºè§†è§‰å’Œå›¾åƒå¤„ç†é¢†åŸŸï¼Œç”¨äºŽç›®æ ‡æ£€æµ‹çš„ç‰¹å¾æè¿°å™¨ã€‚é€™é …æŠ€æœ¯æ˜¯ç”¨æ¥è®¡ç®—å±€éƒ¨å›¾åƒæ¢¯åº¦çš„æ–¹å‘ä¿¡æ¯çš„ç»Ÿè®¡å€¼ã€‚è¿™ç§æ–¹æ³•è·Ÿ**è¾¹ç¼˜æ–¹å‘ç›´æ–¹å›¾ï¼ˆedge orientation histogramsï¼‰****ã€å°ºåº¦ä¸å˜ç‰¹å¾å˜æ¢ï¼ˆscale-invariant feature transform descriptorsï¼‰**ä»¥åŠ**å½¢çŠ¶ä¸Šä¸‹æ–‡æ–¹æ³•ï¼ˆ shape contextsï¼‰**æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä½†ä¸Žå®ƒä»¬çš„ä¸åŒç‚¹æ˜¯ï¼šHOGæè¿°å™¨æ˜¯åœ¨ä¸€ä¸ªç½‘æ ¼å¯†é›†çš„å¤§å°ç»Ÿä¸€çš„ç»†èƒžå•å…ƒï¼ˆdense grid of uniformly spaced cellsï¼‰ä¸Šè®¡ç®—ï¼Œè€Œä¸”ä¸ºäº†æé«˜æ€§èƒ½ï¼Œè¿˜é‡‡ç”¨äº†é‡å çš„å±€éƒ¨å¯¹æ¯”åº¦å½’ä¸€åŒ–ï¼ˆoverlapping local contrast normalizationï¼‰æŠ€æœ¯ã€‚
>
> - å¯¹äºŽä¸€ä¸ªå¥½çš„å›¾åƒç‰¹å¾ï¼Œè‡³å°‘è¦æœ‰ä»¥ä¸‹è¦æ±‚ï¼š
>
>   - 1.èƒ½å¤Ÿæžå¤§ç®€åŒ–æ•°æ®è¡¨è¾¾
>  - 2.èƒ½å¤Ÿä¿ç•™å†…å®¹ç›¸å…³ä¿¡æ¯

## 1.3 æ·±åº¦å­¦ä¹ 

### 1.3.1 ç‰¹å¾å·¥ç¨‹çš„å¤©èŠ±æ¿

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204081949892-2137542462.png)

> - åœ¨ ImageNet å›¾åƒè¯†åˆ«æŒ‘æˆ˜èµ›é‡Œï¼Œ2010 å’Œ 2011 å¹´çš„å† å†›é˜Ÿä¼éƒ½ä½¿ç”¨äº†ç»å…¸çš„è§†è§‰æ–¹æ³•ï¼ŒåŸºäºŽæ‰‹å·¥è®¾è®¡çš„**ç‰¹å¾ + æœºå™¨å­¦ä¹ ç®—æ³•**å®žçŽ°å›¾åƒåˆ†ç±»ï¼ŒTop-5 é”™è¯¯çŽ‡åœ¨ 25% ä¸Šä¸‹
> - å—é™äºŽäººç±»çš„æ™ºæ…§ï¼Œæ‰‹å·¥è®¾è®¡ç‰¹å¾æ›´å¤šå±€é™åœ¨åƒ
>   ç´ å±‚é¢çš„è®¡ç®—ï¼Œä¸¢å¤±ä¿¡æ¯è¿‡å¤šï¼Œåœ¨è§†è§‰ä»»åŠ¡ä¸Šçš„
>   **æ€§èƒ½è¾¾åˆ°ç“¶é¢ˆ**

### 1.3.2 ä»Žç‰¹å¾å·¥ç¨‹åˆ°ç‰¹å¾å­¦ä¹ 

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082014943-1957705325.png)
> - **ç‰¹å¾å·¥ç¨‹**
>   ç‰¹å¾å·¥ç¨‹æœ¬è´¨æ˜¯ä¸€é¡¹å·¥ç¨‹æ´»åŠ¨ï¼Œå®ƒç›®çš„æ˜¯æœ€å¤§é™åº¦åœ°ä»ŽåŽŸå§‹æ•°æ®ä¸­æå–å¹¶åŠ å·¥ç‰¹å¾ä»¥ä¾›æ¨¡åž‹æˆ–è€…ç®—æ³•ä½¿ç”¨ã€‚åœ¨ä¼ ç»Ÿæœºå™¨å­¦ä¹ é¢†åŸŸæµä¼ ç€è¿™æ ·ä¸€å¥è¯ï¼š **â€œæ•°æ®å’Œç‰¹å¾å†³å®šäº†æœºå™¨å­¦ä¹ çš„ä¸Šé™ï¼Œè€Œæ¨¡åž‹å’Œç®—æ³•åªæ˜¯é€¼è¿‘è¿™ä¸ªä¸Šé™è€Œå·²â€**ï¼Œä»Žè€Œå¯è§ç‰¹å¾å·¥ç¨‹çš„é‡è¦æ€§ã€‚å…¶å®žå¯¹äºŽç»“æž„åŒ–æ•°æ®å»ºæ¨¡ï¼Œå³ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¨¡åž‹ï¼Œç‰¹å¾å·¥ç¨‹ä¹Ÿæ˜¯æ¯”æ¨¡åž‹æœ¬èº«è¦é‡è¦çš„
>
> - **ç‰¹å¾å­¦ä¹ **
>   ç‰¹å¾å­¦ä¹ å¯ä»¥åˆ†ä¸º**ç›‘ç£ç‰¹å¾å­¦ä¹ **å’Œ**æ— ç›‘ç£ç‰¹å¾å­¦ä¹ **ï¼š
>   ç›‘ç£ç‰¹å¾å­¦ä¹ åŒ…æ‹¬ç›‘ç£å­—å…¸å­¦ä¹ ã€ç¥žç»ç½‘ç»œã€å¤šå±‚æ„ŸçŸ¥æœºï¼›æ— ç›‘ç£ç‰¹å¾å­¦ä¹ åŒ…æ‹¬æ— ç›‘ç£å­—å…¸å­¦ä¹ ã€ä¸»æˆåˆ†åˆ†æžã€ç‹¬ç«‹æˆåˆ†åˆ†æžã€è‡ªç¼–ç å™¨ã€çŸ©é˜µåˆ†è§£å’Œå„ç§å½¢å¼çš„èšç±»ç®—æ³•ã€‚
>
> > - **ç›‘ç£ç‰¹å¾å­¦ä¹ **
> >   **ç›‘ç£å­—å…¸å­¦ä¹ **
> >   **å­—å…¸å­¦ä¹ **æ˜¯ä»Žè¾“å…¥æ•°æ®ä¸­å­¦ä¹ ä¸€ç»„ä»£è¡¨å…ƒç´ çš„å­—å…¸ï¼Œå…¶ä¸­æ¯ä¸ªæ•°æ®éƒ½å¯ä»¥è¡¨ç¤ºä¸ºä»£è¡¨å…ƒç´ çš„åŠ æƒå’Œã€‚é€šè¿‡æœ€å°åŒ–å¸¦æœ‰L1æ­£åˆ™é¡¹çš„å¹³å‡è¯¯å·®æ¥ç¡®å®šå­—å…¸å…ƒç´ å’Œæƒé‡ï¼Œå¹¶ä¿è¯æƒé‡ç¨€ç–ã€‚
> >   ç›‘ç£å­—å…¸å­¦ä¹ åˆ©ç”¨è¾“å…¥æ•°æ®å’Œæ ‡ç­¾çš„éšå«ç»“æž„æ¥ä¼˜åŒ–å­—å…¸å…ƒç´ ã€‚
> >
> > - **ç¥žç»ç½‘ç»œ**
> >   **ç¥žç»ç½‘ç»œ**æ˜¯ç”¨æ¥æè¿°ä¸€ç³»åˆ—å­¦ä¹ ç®—æ³•ï¼Œé€šè¿‡ç›¸äº’å…³è”çš„èŠ‚ç‚¹æž„æˆçš„å¤šå±‚ç½‘ç»œã€‚å®ƒæ˜¯å—ç¥žç»ç³»ç»Ÿçš„å¯å‘ï¼Œå…¶ä¸­èŠ‚ç‚¹å¯ä»¥çœ‹åšæ˜¯ç¥žç»å…ƒï¼Œè¾¹å¯ä»¥çœ‹æˆæ˜¯çªè§¦ã€‚æ¯ä¸ªè¾¹éƒ½æœ‰ç›¸å¯¹åº”çš„æƒé‡ï¼Œç½‘ç»œå®šä¹‰äº†è®¡ç®—è§„åˆ™ï¼Œå°†æ•°æ®ä»Žè¾“å…¥å±‚ä¼ é€’åˆ°è¾“å‡ºå±‚ã€‚
> >   å¤šå±‚ç¥žç»ç½‘ç»œå¯ä»¥ç”¨æ¥è¿›è¡Œç‰¹å¾å­¦ä¹ ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥å­¦ä¹ åœ¨éšè—å±‚ä¸­çš„è¾“å‡ºçš„è¡¨ç¤º

### 1.3.3 å±‚æ¬¡åŒ–ç‰¹å¾çš„å®žçŽ°æ–¹å¼

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082035342-547872106.png)

> å±‚æ¬¡åŒ–ç‰¹å¾èƒ½å¤Ÿæœ€å¤§ç¨‹åº¦åœ°ä¿è¯æå–å›¾åƒç‰¹å¾ä¿¡æ¯ï¼Œå¯å®žçŽ°çš„æ–¹å¼å¯ä»¥é€šè¿‡**å·ç§¯**å’Œ**å¤šå¤´æ³¨æ„åŠ›**æ¥è¿›è¡Œç‰¹å¾æå–ã€‚
>
> - é€šè¿‡å·ç§¯è¿›è¡Œå±‚æ¬¡åŒ–ç‰¹å¾æå–çš„ç»“æž„å°±ç§°ä¸º**å·ç§¯ç¥žç»ç½‘ç»œ**ï¼Œå·ç§¯åŽå¾—åˆ°çš„ç»“æžœæ˜¯
>   - 1.ç‰¹å¾å’Œå›¾åƒä¸€æ ·å…·æœ‰äºŒç»´ç©ºé—´ç»“æž„
>   - 2.åŽå±‚ç‰¹å¾ä¸ºç©ºé—´é¢†åŸŸå†…å‰å±‚ç‰¹å¾çš„åŠ æƒæ±‚å’Œ
> - é€šè¿‡**å¤šå¤´æ³¨æ„åŠ›**å®žçŽ°ç‰¹å¾æå–çš„ç»“æž„å°±ç§°ä¸º**Transformer**ã€‚
> - ä»¥ä¸Šä¸¤ç§ç»“æž„å’Œæ–¹å¼å‡æ˜¯ç¥žç»ç½‘ç»œç›®å‰åº”ç”¨æ¯”è¾ƒå¹¿æ³›çš„æ–¹å‘ï¼Œä¸”å„å…·æœ‰å…¶ä»£è¡¨æ€§ã€‚

### 1.3.4 AlexNetçš„è¯žç”Ÿ&æ·±åº¦å­¦ä¹ æ—¶ä»£çš„å¼€å§‹

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082111464-1313848810.png)

> 2012å¹´ï¼ŒAlexNetæ¨ªç©ºå‡ºä¸–ã€‚è¿™ä¸ªæ¨¡åž‹çš„åå­—æ¥æºäºŽè®ºæ–‡ç¬¬ä¸€ä½œè€…çš„å§“åAlex Krizhevsky [1]ã€‚AlexNetä½¿ç”¨äº†8å±‚å·ç§¯ç¥žç»ç½‘ç»œï¼Œå¹¶ä»¥å¾ˆå¤§çš„ä¼˜åŠ¿èµ¢å¾—äº†ImageNet 2012å›¾åƒè¯†åˆ«æŒ‘æˆ˜èµ›ã€‚å®ƒé¦–æ¬¡**è¯æ˜Žäº†å­¦ä¹ åˆ°çš„ç‰¹å¾å¯ä»¥è¶…è¶Šæ‰‹å·¥è®¾è®¡çš„ç‰¹å¾**ï¼Œä»Žè€Œä¸€ä¸¾æ‰“ç ´è®¡ç®—æœºè§†è§‰ç ”ç©¶çš„å‰çŠ¶ã€‚


## 1.4 è¯¾ç¨‹å†…å®¹

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082130102-1007042951.png)

> 
> - 1.æ¨¡åž‹è®¾è®¡
> - 2.æ¨¡åž‹å­¦ä¹ 

# 2.æ¨¡åž‹è®¾è®¡

## 2.1.å·ç§¯ç¥žç»ç½‘ç»œ

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082157252-251063350.png)

### 2.1 .1 AlexNet (2012)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082221396-416258100.png)

> AlexNet æ¨¡åž‹åŒ…å« 6 åƒä¸‡ä¸ªå‚æ•°å’Œ 65 ä¸‡ä¸ªç¥žç»å…ƒï¼ŒåŒ…å« 5 ä¸ªå·ç§¯å±‚ï¼Œå…¶ä¸­æœ‰å‡ å±‚åŽé¢è·Ÿç€æœ€å¤§æ± åŒ–ï¼ˆmax-poolingï¼‰å±‚ï¼Œä»¥åŠ 3 ä¸ªå…¨è¿žæŽ¥å±‚ï¼Œæœ€åŽè¿˜æœ‰ä¸€ä¸ª 1000 è·¯çš„ softmax å±‚ã€‚ä¸ºäº†åŠ å¿«è®­ç»ƒé€Ÿåº¦ï¼ŒAlexNet ä½¿ç”¨äº† Relu éžçº¿æ€§æ¿€æ´»å‡½æ•°ä»¥åŠä¸€ç§é«˜æ•ˆçš„åŸºäºŽ GPU çš„å·ç§¯è¿ç®—æ–¹æ³•ã€‚ä¸ºäº†å‡å°‘å…¨è¿žæŽ¥å±‚çš„è¿‡æ‹Ÿåˆï¼ŒAlexNet é‡‡ç”¨äº†æœ€æ–°çš„ â€œDropoutâ€é˜²æ­¢è¿‡æ‹Ÿåˆæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¢«è¯æ˜Žéžå¸¸æœ‰æ•ˆã€‚

### 2..1.2 Going Deeper (2012~2014)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082304791-1342672938.png)

> åœ¨AlexNetç»è¿‡éªŒè¯åŽï¼Œå»¶ä¼¸å‡ºæ¥çš„ç½‘ç»œä¹Ÿå¼€å§‹å¾€æ›´æ·±åº¦ã€æ›´æ·±å±‚çš„æ–¹å‘åŽ»å‘å±•ã€‚
>
> - VGG-19ï¼š(19å±‚) å‡†ç¡®çŽ‡ï¼š92.7%
> - GoogleLeNetï¼š(22å±‚ï¼‰å‡†ç¡®çŽ‡ï¼š93.4%

### 2.1.3 VGG (2014)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082321011-1846916898.png)

> VGGï¼Œå®ƒçš„åå­—æ¥æºäºŽè®ºæ–‡ä½œè€…æ‰€åœ¨çš„å®žéªŒå®¤Visual Geometry Group [1]ã€‚VGGæå‡ºäº†å¯ä»¥é€šè¿‡é‡å¤ä½¿ç”¨ç®€å•çš„åŸºç¡€å—æ¥æž„å»ºæ·±åº¦æ¨¡åž‹çš„æ€è·¯ã€‚
>
> VGGå—çš„ç»„æˆè§„å¾‹æ˜¯ï¼šè¿žç»­ä½¿ç”¨æ•°ä¸ªç›¸åŒçš„å¡«å……ä¸º1ã€çª—å£å½¢çŠ¶ä¸º3Ã—3çš„å·ç§¯å±‚åŽæŽ¥ä¸Šä¸€ä¸ªæ­¥å¹…ä¸º2ã€çª—å£å½¢çŠ¶ä¸º2Ã—2çš„æœ€å¤§æ± åŒ–å±‚ã€‚å·ç§¯å±‚ä¿æŒè¾“å…¥çš„é«˜å’Œå®½ä¸å˜ï¼Œè€Œæ± åŒ–å±‚åˆ™å¯¹å…¶å‡åŠã€‚æˆ‘ä»¬ä½¿ç”¨`vgg_block`å‡½æ•°æ¥å®žçŽ°è¿™ä¸ªåŸºç¡€çš„VGGå—ï¼Œå®ƒå¯ä»¥æŒ‡å®šå·ç§¯å±‚çš„æ•°é‡`num_convs`å’Œè¾“å‡ºé€šé“æ•°`num_channels`ã€‚
>
> ä¸ŽAlexNetå’ŒLeNetä¸€æ ·ï¼ŒVGGç½‘ç»œç”±å·ç§¯å±‚æ¨¡å—åŽæŽ¥å…¨è¿žæŽ¥å±‚æ¨¡å—æž„æˆã€‚å·ç§¯å±‚æ¨¡å—ä¸²è”æ•°ä¸ª`vgg_block`ï¼Œå…¶è¶…å‚æ•°ç”±å˜é‡`conv_arch`å®šä¹‰ã€‚è¯¥å˜é‡æŒ‡å®šäº†æ¯ä¸ªVGGå—é‡Œå·ç§¯å±‚ä¸ªæ•°å’Œè¾“å‡ºé€šé“æ•°ã€‚å…¨è¿žæŽ¥æ¨¡å—åˆ™ä¸ŽAlexNetä¸­çš„ä¸€æ ·ã€‚

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082329469-1882376281.png)


### 2.1.4 GoogLeNet (Inception v1, 2014)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082345948-1740705009.png)

> åœ¨2014å¹´çš„ImageNetå›¾åƒè¯†åˆ«æŒ‘æˆ˜èµ›ä¸­ï¼Œä¸€ä¸ªåå«GoogLeNetçš„ç½‘ç»œç»“æž„å¤§æ”¾å¼‚å½© [1]ã€‚å®ƒè™½ç„¶åœ¨åå­—ä¸Šå‘LeNetè‡´æ•¬ï¼Œä½†åœ¨ç½‘ç»œç»“æž„ä¸Šå·²ç»å¾ˆéš¾çœ‹åˆ°LeNetçš„å½±å­ã€‚
>
> - GoogLeNetä¸­çš„åŸºç¡€å·ç§¯å—å«ä½œInceptionå—ï¼Œå¾—åäºŽåŒåç”µå½±ã€Šç›—æ¢¦ç©ºé—´ã€‹ï¼ˆInceptionï¼‰ã€‚
> ![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204105116928-781994322.png)
> - Inceptionå—é‡Œæœ‰4æ¡å¹¶è¡Œçš„çº¿è·¯ã€‚å‰3æ¡çº¿è·¯ä½¿ç”¨çª—å£å¤§å°åˆ†åˆ«æ˜¯1Ã—1ã€3Ã—3å’Œ5Ã—5çš„å·ç§¯å±‚æ¥æŠ½å–ä¸åŒç©ºé—´å°ºå¯¸ä¸‹çš„ä¿¡æ¯ï¼Œå…¶ä¸­ä¸­é—´2ä¸ªçº¿è·¯ä¼šå¯¹è¾“å…¥å…ˆåš1Ã—1å·ç§¯æ¥å‡å°‘è¾“å…¥é€šé“æ•°ï¼Œä»¥é™ä½Žæ¨¡åž‹å¤æ‚åº¦ã€‚ç¬¬å››æ¡çº¿è·¯åˆ™ä½¿ç”¨3Ã—3æœ€å¤§æ± åŒ–å±‚ï¼ŒåŽæŽ¥1Ã—1å·ç§¯å±‚æ¥æ”¹å˜é€šé“æ•°ã€‚4æ¡çº¿è·¯éƒ½ä½¿ç”¨äº†åˆé€‚çš„å¡«å……æ¥ä½¿è¾“å…¥ä¸Žè¾“å‡ºçš„é«˜å’Œå®½ä¸€è‡´ã€‚æœ€åŽæˆ‘ä»¬å°†æ¯æ¡çº¿è·¯çš„è¾“å‡ºåœ¨é€šé“ç»´ä¸Šè¿žç»“ï¼Œå¹¶è¾“å…¥æŽ¥ä¸‹æ¥çš„å±‚ä¸­åŽ»ã€‚
>
>   Inceptionå—ä¸­å¯ä»¥è‡ªå®šä¹‰çš„è¶…å‚æ•°æ˜¯æ¯ä¸ªå±‚çš„è¾“å‡ºé€šé“æ•°ï¼Œæˆ‘ä»¬ä»¥æ­¤æ¥æŽ§åˆ¶æ¨¡åž‹å¤æ‚åº¦ã€‚


### 2.1.5 å·ç§¯ç¥žç»ç½‘ç»œä¼˜åŒ–

#### 2.1.5.1 ç²¾åº¦é€€åŒ–é—®é¢˜

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082457271-1478489654.png)

> éšç€æ·±åº¦å­¦ä¹ ä¸Žç¥žç»ç½‘ç»œçš„è¿­ä»£å‘å±•ï¼Œå‡ºçŽ°äº†ä¼—å¤šäº†ç½‘ç»œæ¨¡åž‹ç»“æž„ï¼Œä½†æ˜¯éšä¹‹å‡ºçŽ°çš„é—®é¢˜æ˜¯ï¼Œå½“æ¨¡åž‹å±‚æ•°å¢žåŠ åˆ°ä¸€å®šç¨‹åº¦åŽï¼Œæ¨¡åž‹åˆ†ç±»çš„æ­£ç¡®çŽ‡ä¸å¢žåè€Œé™ä½Žäº†ã€‚

#### 2.1.5.2 å®žéªŒçš„åç›´è§‰

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082511937-122335246.png)

> ç²¾åº¦é€€åŒ–é—®é¢˜çœ‹èµ·æ¥æœ‰äº›åç›´è§‰ï¼Œä½†å®žéªŒè¡¨æ˜Žï¼Œå½“å·ç§¯é€€åŒ–ä¸ºæ’ç­‰æ˜ å°„æ—¶ï¼Œæ·±å±‚ç½‘ç»œä¸Žæµ…å±‚ç½‘ç»œç›¸åŒï¼Œæ‰€ä»¥æ·±åº¦ç½‘ç»œè‡³å°‘åº”å…·å¤‡ä¸å·®äºŽæµ…å±‚ç½‘ç»œçš„åˆ†ç±»ç²¾åº¦ï¼Œè¿™æ ·æ·±å±‚ç½‘ç»œçš„å åŠ æ‰èƒ½å‘æŒ¥ä½œç”¨ã€‚
> åŒæ—¶ï¼Œä¹Ÿå¯ä»¥è¿›ä¸€æ­¥å¾—åˆ°ä¸€ä¸ªçŒœæƒ³ï¼šè™½ç„¶æ·±å±‚ç½‘ç»œæœ‰æ½œåŠ›è¾¾åˆ°æ›´é«˜çš„ç²¾åº¦ï¼Œä½†å¸¸è§„çš„ä¼˜åŒ–ç®—æ³•éš¾ä»¥æ‰¾åˆ°è¿™ä¸ªæ›´ä¼˜çš„æ¨¡åž‹ï¼Œä¹Ÿå³è®©æ–°å¢žåŠ çš„å·ç§¯å±‚æ‹Ÿåˆä¸€ä¸ªè¿‘ä¼¼æ’ç­‰æ˜ å°„ï¼Œæ°å¥½å¯ä»¥è®©æµ…å±‚ç½‘ç»œå˜å¥½ä¸€ç‚¹ã€‚

#### 2.1.5.3 æ®‹å·®å­¦ä¹ çš„åŸºæœ¬æ€è·¯

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082524840-924808710.png)

> - **è®©æˆ‘ä»¬å…ˆæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå¯¹ç¥žç»ç½‘ç»œæ¨¡åž‹æ·»åŠ æ–°çš„å±‚ï¼Œå……åˆ†è®­ç»ƒåŽçš„æ¨¡åž‹æ˜¯å¦åªå¯èƒ½æ›´æœ‰æ•ˆåœ°é™ä½Žè®­ç»ƒè¯¯å·®ï¼Ÿ**
>   ç†è®ºä¸Šï¼ŒåŽŸæ¨¡åž‹è§£çš„ç©ºé—´åªæ˜¯æ–°æ¨¡åž‹è§£çš„ç©ºé—´çš„å­ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœæˆ‘ä»¬èƒ½å°†æ–°æ·»åŠ çš„å±‚è®­ç»ƒæˆæ’ç­‰æ˜ å°„*f*(*x*)=*x*ï¼Œæ–°æ¨¡åž‹å’ŒåŽŸæ¨¡åž‹å°†åŒæ ·æœ‰æ•ˆã€‚ç”±äºŽæ–°æ¨¡åž‹å¯èƒ½å¾—å‡ºæ›´ä¼˜çš„è§£æ¥æ‹Ÿåˆè®­ç»ƒæ•°æ®é›†ï¼Œå› æ­¤æ·»åŠ å±‚ä¼¼ä¹Žæ›´å®¹æ˜“é™ä½Žè®­ç»ƒè¯¯å·®ã€‚ç„¶è€Œåœ¨å®žè·µä¸­ï¼Œæ·»åŠ è¿‡å¤šçš„å±‚åŽè®­ç»ƒè¯¯å·®å¾€å¾€ä¸é™åå‡ã€‚å³ä½¿åˆ©ç”¨æ‰¹é‡å½’ä¸€åŒ–å¸¦æ¥çš„æ•°å€¼ç¨³å®šæ€§ä½¿è®­ç»ƒæ·±å±‚æ¨¡åž‹æ›´åŠ å®¹æ˜“ï¼Œè¯¥é—®é¢˜ä»ç„¶å­˜åœ¨ã€‚é’ˆå¯¹è¿™ä¸€é—®é¢˜ï¼Œä½•æºæ˜Žç­‰äººæå‡ºäº†æ®‹å·®ç½‘ç»œï¼ˆResNetï¼‰ã€‚å®ƒåœ¨2015å¹´çš„ImageNetå›¾åƒè¯†åˆ«æŒ‘æˆ˜èµ›å¤ºé­ï¼Œå¹¶æ·±åˆ»å½±å“äº†åŽæ¥çš„æ·±åº¦ç¥žç»ç½‘ç»œçš„è®¾è®¡ã€‚
>
> **æ®‹å·®å»ºæ¨¡**ï¼šè®©æ–°å¢žåŠ çš„å±‚æ‹Ÿåˆæµ…å±‚ç½‘ç»œä¸Žæ·±å±‚ç½‘ç»œä¹‹é—´çš„å·®å¼‚ï¼Œæ›´å®¹æ˜“å­¦ä¹ æ¢¯åº¦å¯ä»¥ç›´æŽ¥å›žä¼ åˆ°æµ…å±‚ç½‘ç»œç›‘ç£æµ…å±‚ç½‘ç»œçš„å­¦ä¹ æ²¡æœ‰å¼•å…¥é¢å¤–å‚å…¥ï¼Œè®©å‚æ•°æ›´æœ‰æ•ˆè´¡çŒ®åˆ°æœ€ç»ˆçš„æ¨¡åž‹ä¸­ã€‚
> ![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204110222522-495762158.png)


### 2.1.6 æ®‹å·®ç½‘ç»œResNet(2015)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082618784-583330571.png)

> ResNetæ²¿ç”¨äº†VGGå…¨$3\times 3$å·ç§¯å±‚çš„è®¾è®¡ã€‚æ®‹å·®å—é‡Œé¦–å…ˆæœ‰2ä¸ªæœ‰ç›¸åŒè¾“å‡ºé€šé“æ•°çš„$3\times 3$å·ç§¯å±‚ã€‚
> æ¯ä¸ªå·ç§¯å±‚åŽæŽ¥ä¸€ä¸ªæ‰¹é‡å½’ä¸€åŒ–å±‚å’ŒReLUæ¿€æ´»å‡½æ•°ã€‚
> ç„¶åŽæˆ‘ä»¬å°†è¾“å…¥è·³è¿‡è¿™2ä¸ªå·ç§¯è¿ç®—åŽç›´æŽ¥åŠ åœ¨æœ€åŽçš„ReLUæ¿€æ´»å‡½æ•°å‰ã€‚
> è¿™æ ·çš„è®¾è®¡è¦æ±‚2ä¸ªå·ç§¯å±‚çš„è¾“å‡ºä¸Žè¾“å…¥å½¢çŠ¶ä¸€æ ·ï¼Œä»Žè€Œå¯ä»¥ç›¸åŠ ã€‚å¦‚æžœæƒ³æ”¹å˜é€šé“æ•°ï¼Œå°±éœ€è¦å¼•å…¥ä¸€ä¸ªé¢å¤–çš„$1\times 1$å·ç§¯å±‚æ¥å°†è¾“å…¥å˜æ¢æˆéœ€è¦çš„å½¢çŠ¶åŽå†åšç›¸åŠ è¿ç®—ã€‚

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082720750-1200821892.png)

> ResNetå¯ä»¥æœ‰æ•ˆçš„æ¶ˆé™¤å·ç§¯å±‚æ•°å¢žåŠ å¸¦æ¥çš„æ¢¯åº¦å¼¥æ•£æˆ–æ¢¯åº¦çˆ†ç‚¸é—®é¢˜ã€‚
>
> åœ¨ResNet-34ç»“æž„ä¸­
>
> - ç»“æž„å…±åˆ†ä¸º5çº§ï¼Œæ¯çº§åŒ…å«è‹¥å¹²æ®‹å·®æ¨¡å—ï¼Œä¸åŒæ®‹å·®æ¨¡å—ä¸ªæ•°ä¸åŒ ResNet ç»“æž„
> - æ¯çº§è¾“å‡ºåˆ†è¾¨çŽ‡å‡åŠï¼Œé€šé“å€å¢ž
> - å…¨å±€å¹³å‡æ± åŒ–åŽ‹ç¼©ç©ºé—´ç»´åº¦
> - å•å±‚å…¨è¿žæŽ¥å±‚äº§ç”Ÿç±»åˆ«æ¦‚çŽ‡
>
> ResNeté€šè¿‡æ”¹å˜å­¦ä¹ ç›®æ ‡ï¼Œå³ç”±å­¦ä¹ å®Œæ•´çš„è¾“å‡ºå˜ä¸ºå­¦ä¹ æ®‹å·®ï¼Œè§£å†³äº†ä¼ ç»Ÿå·ç§¯åœ¨ä¿¡æ¯ä¼ é€’æ—¶å­˜åœ¨çš„ä¿¡æ¯ä¸¢å¤±æ ¸æŸè€—é—®é¢˜ï¼Œé€šè¿‡å°†è¾“å…¥ç›´æŽ¥ç»•é“ä¼ é€’åˆ°è¾“å‡ºï¼Œä¿æŠ¤äº†ä¿¡æ¯çš„å®Œæ•´æ€§ã€‚æ­¤å¤–å­¦ä¹ ç›®æ ‡çš„ç®€åŒ–ä¹Ÿé™ä½Žäº†å­¦ä¹ éš¾åº¦ã€‚

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082730072-1046080248.png)

#### 2.1.6.1 ResrNetä¸­çš„ä¸¤ç§æ®‹å·®æ¨¡å—

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082750876-1092636858.png)

> ResNetæœ‰ä¸¤ç§æ®‹å·®æ¨¡å—ï¼Œ**Basic block**å’Œ**Bottleneck block**ï¼š
>
> - **Basic block**
>   - Basic blockä¸ºResNetä¸­çš„ä¸€ç§ç½‘ç»œç»“æž„ï¼ŒBasicBlockåŒ…å«äº†æ®‹å·®æ”¯è·¯å’Œä¸€ä¸ªshort-cutæ”¯è·¯ï¼Œç”±äºŽæ¯”ä¼ ç»Ÿå·ç§¯ç»“æž„å¤šäº†ä¸€ä¸ªshort-cutæ”¯è·¯ç”¨äºŽä¼ é€’ä½Žå±‚ä¿¡æ¯ï¼Œä½¿å¾—ç½‘ç»œèƒ½å¤Ÿè®­ç»ƒåœ°å¾ˆæ·±ã€‚
>   - BasicBlockæž¶æž„ä¸»è¦ä½¿ç”¨äº†ä¸¤ä¸ª3*3çš„å·ç§¯ï¼Œç„¶åŽè¿›è¡ŒBN(BatchNorma2d)ï¼Œå†å°†ç‰¹å¾ä¼ é€’ç»™ReLUã€‚
> -  **Bottleneck**
>   Bottleneckç”±1x1ï¼Œ3x3ï¼Œ1x1 ä¸‰ä¸ªconvolutionsæž„æˆï¼Œå…¶ä¸­1x1å·ç§¯å±‚çš„ä½œç”¨æ˜¯å…ˆå‡å°‘å†æ¢å¤ç»´åº¦ï¼Œ3x3å±‚æ˜¯è¾ƒå°è¾“å…¥/è¾“å‡ºç»´åº¦çš„ç“¶é¢ˆã€‚Bottleneckç”¨äºŽç‰¹å¾é™ç»´ï¼Œå‡å°‘ç‰¹å¾å›¾çš„å±‚æ•°ï¼Œå‡å°‘å‚æ•°é‡ä»Žè€Œå‡å°‘è®¡ç®—é‡ã€‚(ä¸€èˆ¬åœ¨ç½‘ç»œè¾ƒæ·±æ—¶æ‰ä½¿ç”¨bottleneckç»“æž„ï¼Œå¦‚ResNet18 ResNet34ç”¨BasicBlockï¼Œè€ŒResNet50 ResNet101ç”¨Bottleneck)

#### 2.1.6.2 ResNetçš„æˆå°±å’Œå½±å“åŠ›

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082822051-720890168.png)

> ã€ŠDeep Residual Learning for Image Recognitionã€‹åœ¨ 2016 å¹´æ‹¿ä¸‹äº†è®¡ç®—æœºè§†è§‰é¡¶çº§ä¼šè®® CVPR çš„æœ€ä½³è®ºæ–‡å¥–ï¼Œç›¸æ¯” NeurIPS æœ€é«˜çƒ­åº¦è®ºæ–‡ã€ŠAttention is All You Needã€‹ï¼ŒResNet çš„è¢«å¼•æ•°å¤šå‡ºäº†å‡ å€ã€‚è¿™ä¸€å·¥ä½œçš„çƒ­åº¦å¦‚æ­¤ä¹‹é«˜ï¼Œä¸ä»…æ˜¯å› ä¸º ResNet æœ¬èº«çš„ä¹…ç»è€ƒéªŒï¼Œä¹ŸéªŒè¯äº† AI é¢†åŸŸï¼Œç‰¹åˆ«æ˜¯è®¡ç®—æœºè§†è§‰å¦‚ä»Šçš„ç«çƒ­ç¨‹åº¦ã€‚

#### 2.1.6.3 ResNetæ˜¯æ·±æµ…æ¨¡åž‹çš„é›†æˆ

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082833695-658968849.png)

> å¯¹äºŽç¥žç»ç½‘ç»œç»“æž„æ¥è¯´ï¼ŒResNetç›¸å½“äºŽæ˜¯æ·±å±‚æ¨¡åž‹ä¸Žæµ…å±‚æ¨¡åž‹çš„é›†æˆï¼Œç­‰åŒäºŽå¤šæ¨¡åž‹é›†æˆã€‚
>
> - æ®‹å·®ç½‘ç»œæœ‰ $O(2^ð‘›) $ä¸ªéšå¼çš„è·¯å¾„æ¥è¿žæŽ¥è¾“å…¥å’Œè¾“å‡ºï¼Œæ¯æ·»åŠ ä¸€ä¸ªå—ä¼šä½¿è·¯å¾„æ•°ç¿»å€

#### 2.1.6.4 æ®‹å·®è¿žæŽ¥è®©æŸå¤±æ›²é¢æ›´å¹³æ»‘

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082852433-1256630448.png)

> æ‰€è°“æ®‹å·®è¿žæŽ¥æŒ‡çš„å°±æ˜¯å°†æµ…å±‚çš„è¾“å‡ºå’Œæ·±å±‚çš„è¾“å‡ºæ±‚å’Œä½œä¸ºä¸‹ä¸€é˜¶æ®µçš„è¾“å…¥ï¼Œè¿™æ ·åšçš„ç»“æžœå°±æ˜¯æœ¬æ¥è¿™ä¸€å±‚æƒé‡éœ€è¦å­¦ä¹ æ˜¯ä¸€ä¸ªå¯¹$x$åˆ°$f(x)$çš„æ˜ å°„ã€‚é‚£ä½¿ç”¨æ®‹å·®é“¾æŽ¥ä»¥åŽï¼Œæƒé‡éœ€è¦å­¦ä¹ çš„æ˜ å°„å˜æˆäº†$x->f(x)-x$ ï¼Œè¿™æ ·åœ¨åå‘ä¼ æ’­çš„è¿‡ç¨‹ä¸­ï¼Œå°æŸå¤±çš„æ¢¯åº¦æ›´å®¹æ˜“æŠµè¾¾æµ…å±‚çš„ç¥žç»å…ƒã€‚å…¶å®žæ®‹å·®è¿žæŽ¥å¯ä»¥çœ‹æˆä¸€ç§ç‰¹æ®Šçš„è·³è·ƒè¿žæŽ¥ã€‚

#### 2.1.6.5 ResNetçš„åŽç»­æ”¹è¿›

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082905834-565144964.png)

> å…³äºŽResNetçš„åŽç»­æ”¹è¿›æœ‰è¿™äº›ç³»åˆ—
>
> - ResNet B/C/Dï¼šæ®‹å·®æ¨¡å—çš„å±€éƒ¨æ”¹è¿›
> - RseNextï¼šä½¿ç”¨åˆ†ç»„å·ç§¯ï¼Œé™ä½Žå‚æ•°é‡
> - SEResNetï¼šåœ¨é€šé“ç»´åº¦å¼•å…¥æ³¨æ„åŠ›æœºåˆ¶

## 2.2 æ›´å¼ºçš„å›¾åƒåˆ†ç±»æ¨¡åž‹

é™¤äº†ä»¥ä¸Šçš„å›¾åƒåˆ†ç±»æ¨¡åž‹ï¼Œç›®å‰ç ”ç©¶å­¦è€…åœ¨å‰äººçš„åŸºç¡€ä¸Šä¹Ÿå‘å±•å‡ºäº†æ›´å¼ºæ›´æœ‰æ•ˆçš„å›¾åƒåˆ†ç±»æ¨¡åž‹ï¼Œä¾‹å¦‚NASã€Vision Transformerã€ConvNeXtç­‰ã€‚

### 2.2.1 ç¥žç»ç»“æž„æœç´¢ Neural Architecture Search (2016+)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204082953676-268414068.png)

> å¯¹äºŽæ·±åº¦å­¦ä¹ è¯´ï¼Œè¶…å‚æ•°ä¸»è¦å¯ä¸ºä¸¤ç±»ï¼šä¸€ç±»æ˜¯**è®­ç»ƒå‚æ•°**ï¼ˆå¦‚learning rateï¼Œbatch sizeï¼Œweight decayç­‰ï¼‰ï¼›å¦ä¸€ç±»æ˜¯**å®šä¹‰ç½‘ç»œç»“æž„çš„å‚æ•°**ï¼ˆæ¯”å¦‚æœ‰å‡ å±‚ï¼Œæ¯å±‚æ˜¯å•¥ç®—å­ï¼Œå·ç§¯ä¸­çš„filter sizeç­‰ï¼‰ï¼Œå®ƒå…·æœ‰ç»´åº¦é«˜ï¼Œç¦»æ•£ä¸”ç›¸äº’ä¾èµ–ç­‰ç‰¹ç‚¹ã€‚å‰è€…çš„è‡ªåŠ¨è°ƒä¼˜ä»æ˜¯HOçš„èŒƒç•´ï¼Œè€ŒåŽè€…çš„è‡ªåŠ¨è°ƒä¼˜ä¸€èˆ¬ç§°ä¸º**ç½‘ç»œæž¶æž„æœç´¢ï¼ˆNeural Architecture Searchï¼ŒNASï¼‰**ã€‚è¿™äº›å¹´æ¥å¤§çƒ­çš„æ·±åº¦ç¥žç»ç½‘ç»œï¼Œè™½ç„¶å°†ä»¥å‰å¾ˆå¦äººå¤´ç–¼çš„ç‰¹å¾æå–è‡ªåŠ¨åŒ–äº†ï¼Œä½†ç½‘ç»œç»“æž„çš„è®¾è®¡å¾ˆå¤§ç¨‹åº¦ä¸Šè¿˜æ˜¯éœ€è¦äººè‚‰ï¼Œä¸”ä¾èµ–ç»éªŒã€‚æ¯å¹´å„AIé¡¶ä¼šä¸Šä¸€å¤§æ‰¹è®ºæ–‡å°±æ˜¯åœ¨æå‡ºå„ç§æ–°çš„æ›´ä¼˜çš„ç½‘ç»œå­ç»“æž„ã€‚ä¸€ä¸ªè‡ªç„¶çš„è¯‰æ±‚å°±æ˜¯è¿™ä¸ªå·¥ä½œèƒ½å¦äº¤ç»™æœºå™¨æ¥åšã€‚
>
> æœ¬è´¨ä¸Šç½‘ç»œæž¶æž„æœç´¢ï¼Œå’Œå›´æ£‹ç±»ä¼¼ï¼Œæ˜¯ä¸ªé«˜ç»´ç©ºé—´çš„æœ€ä¼˜å‚æ•°æœç´¢é—®é¢˜ã€‚
>
> NASçš„å¥—è·¯å¤§å¤šæ˜¯è¿™æ ·çš„ï¼šå…ˆå®šä¹‰æœç´¢ç©ºé—´ï¼Œç„¶åŽé€šè¿‡æœç´¢ç­–ç•¥æ‰¾å‡ºå€™é€‰ç½‘ç»œç»“æž„ï¼Œå¯¹å®ƒä»¬è¿›è¡Œè¯„ä¼°ï¼Œæ ¹æ®åé¦ˆè¿›è¡Œä¸‹ä¸€è½®çš„æœç´¢

### 2.2.2 Vision Transformers (2020+)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204083023064-1109031434.png)

> 2022 å¹´ï¼ŒVision Transformer (ViT) ä½œä¸ºå·ç§¯ç¥žç»ç½‘ç»œ (CNN) çš„ç«žäº‰æ›¿ä»£å“å‡ºçŽ°ï¼Œå·ç§¯ç¥žç»ç½‘ç»œ(CNN) ç›®å‰æ˜¯è®¡ç®—æœºè§†è§‰é¢†åŸŸçš„æœ€å…ˆè¿›æŠ€æœ¯ï¼Œå› æ­¤å¹¿æ³›ç”¨äºŽä¸åŒçš„å›¾åƒè¯†åˆ«ä»»åŠ¡ã€‚ViT æ¨¡åž‹åœ¨è®¡ç®—æ•ˆçŽ‡å’Œå‡†ç¡®æ€§æ–¹é¢ä¼˜äºŽå½“å‰æœ€å…ˆè¿›çš„ (CNN) è¿‘ 4 å€ã€‚
>
> **CNN å’Œ ViT çš„åŒºåˆ«ï¼ˆViT vs. CNNï¼‰** 
> ä¸Žå·ç§¯ç¥žç»ç½‘ç»œ (CNN) ç›¸æ¯”ï¼ŒVision Transformer (ViT) å–å¾—äº†æ˜¾ç€çš„æ•ˆæžœï¼ŒåŒæ—¶èŽ·å¾—äº†æ›´å°‘çš„é¢„è®­ç»ƒè®¡ç®—èµ„æºã€‚ä¸Žå·ç§¯ç¥žç»ç½‘ç»œ (CNN) ç›¸æ¯” ï¼Œ Vision Transformer ( ViT ) è¡¨çŽ°å‡ºæ™®éè¾ƒå¼±çš„å½’çº³åå·®ï¼Œå¯¼è‡´åœ¨å¯¹è¾ƒå°æ•°æ®é›†è¿›è¡Œè®­ç»ƒæ—¶å¢žåŠ å¯¹æ¨¡åž‹æ­£åˆ™åŒ–æˆ–æ•°æ®å¢žå¼º(AugReg) çš„ä¾èµ–ã€‚ ViT æ˜¯åŸºäºŽæœ€åˆä¸ºåŸºäºŽæ–‡æœ¬çš„ä»»åŠ¡è®¾è®¡çš„è½¬æ¢å™¨æž¶æž„çš„å¯è§†åŒ–æ¨¡åž‹ã€‚
>
> - ViT æ¨¡åž‹å°†è¾“å…¥å›¾åƒè¡¨ç¤ºä¸ºä¸€ç³»åˆ—å›¾åƒå—ï¼Œå°±åƒä½¿ç”¨æ–‡æœ¬è½¬æ¢å™¨æ—¶ä½¿ç”¨çš„ä¸€ç³»åˆ—è¯åµŒå…¥ä¸€æ ·ï¼Œå¹¶ç›´æŽ¥é¢„æµ‹å›¾åƒçš„ç±»æ ‡ç­¾ã€‚å½“å¯¹è¶³å¤Ÿçš„æ•°æ®è¿›è¡Œè®­ç»ƒæ—¶ï¼ŒViT è¡¨çŽ°å‡ºéžå‡¡çš„æ€§èƒ½ï¼Œæ‰“ç ´äº†ç±»ä¼¼çš„æœ€å…ˆè¿› CNN çš„æ€§èƒ½ï¼Œè®¡ç®—èµ„æºå‡å°‘äº† 4 å€ã€‚
>
> -  è¿™äº›è½¬æ¢å™¨åœ¨ NLP æ¨¡åž‹æ–¹é¢å…·æœ‰å¾ˆé«˜çš„æˆåŠŸçŽ‡ï¼ŒçŽ°åœ¨ä¹Ÿåº”ç”¨äºŽå›¾åƒè¯†åˆ«ä»»åŠ¡ã€‚CNN ä½¿ç”¨åƒç´ é˜µåˆ—ï¼Œè€Œ ViT å°†å›¾åƒæ‹†åˆ†ä¸ºè§†è§‰æ ‡è®°ã€‚è§†è§‰å˜æ¢å™¨å°†å›¾åƒåˆ†æˆå›ºå®šå¤§å°çš„å—ï¼Œæ­£ç¡®åœ°åµŒå…¥æ¯ä¸ªå—ï¼Œå¹¶å°†ä½ç½®åµŒå…¥ä½œä¸ºå˜æ¢å™¨ç¼–ç å™¨çš„è¾“å…¥ã€‚
>
> - æ­¤å¤–ï¼Œåœ¨è®¡ç®—æ•ˆçŽ‡å’Œå‡†ç¡®æ€§æ–¹é¢ï¼Œ ViT æ¨¡åž‹çš„æ€§èƒ½å‡ ä¹Žæ˜¯ CNN çš„å››å€ã€‚ ViT ä¸­çš„è‡ªæ³¨æ„åŠ›å±‚ä½¿å¾—åœ¨æ•´ä¸ªå›¾åƒä¸­å…¨å±€åµŒå…¥ä¿¡æ¯æˆä¸ºå¯èƒ½ã€‚è¯¥æ¨¡åž‹è¿˜å­¦ä¹ è®­ç»ƒæ•°æ®ä»¥ç¼–ç å›¾åƒå—çš„ç›¸å¯¹ä½ç½®ä»¥é‡å»ºå›¾åƒçš„ç»“æž„ã€‚
>
>   **Transformerç¼–ç å™¨**åŒ…æ‹¬ï¼š 
>
>   - **å¤šå¤´è‡ªæ³¨æ„åŠ›å±‚ (MSP)**ï¼šè¯¥å±‚å°†æ‰€æœ‰æ³¨æ„åŠ›è¾“å‡ºçº¿æ€§è¿žæŽ¥åˆ°æ­£ç¡®çš„ç»´åº¦ã€‚è®¸å¤šæ³¨æ„åŠ›å¤´æœ‰åŠ©äºŽè®­ç»ƒå›¾åƒä¸­çš„å±€éƒ¨å’Œå…¨å±€ä¾èµ–æ€§ã€‚ 
>   - **å¤šå±‚æ„ŸçŸ¥å™¨ (MLP) å±‚**ï¼šè¯¥å±‚åŒ…å«ä¸€ä¸ªå¸¦æœ‰é«˜æ–¯è¯¯å·®çº¿æ€§å•å…ƒ (GELU) çš„ä¸¤å±‚ã€‚ 
>   - **Layer Norm (LN)**ï¼šè¿™æ˜¯åœ¨æ¯ä¸ªå—ä¹‹å‰æ·»åŠ çš„ï¼Œå› ä¸ºå®ƒä¸åŒ…æ‹¬è®­ç»ƒå›¾åƒä¹‹é—´çš„ä»»ä½•æ–°ä¾èµ–å…³ç³»ã€‚å› æ­¤ï¼Œè¿™æœ‰åŠ©äºŽç¼©çŸ­è®­ç»ƒæ—¶é—´å¹¶æé«˜æ•´ä½“æ€§èƒ½ã€‚ æ­¤å¤–ï¼Œæ¯ä¸ªå—ä¹‹åŽéƒ½åŒ…å«æ®‹å·®è¿žæŽ¥ï¼Œå› ä¸ºå®ƒä»¬å…è®¸ç»„ä»¶ç›´æŽ¥æµè¿‡ç½‘ç»œè€Œä¸é€šè¿‡éžçº¿æ€§æ¿€æ´»ã€‚ åœ¨å›¾åƒåˆ†ç±»çš„æƒ…å†µä¸‹ï¼ŒMLP å±‚å®žçŽ°åˆ†ç±»å¤´ã€‚å®ƒåœ¨é¢„è®­ç»ƒæ—¶ä½¿ç”¨ä¸€ä¸ªéšè—å±‚ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªçº¿æ€§å±‚è¿›è¡Œå¾®è°ƒã€‚
>     Read more at: https://viso.ai/deep-learning/vision-tr`ansformer-vit/

### 2.2.3 ConvNeXt (2022)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204083111764-1416790270.png)

> ç¥žç»ç½‘ç»œæž¶æž„è®¾è®¡çš„åˆ›æ–°åœ¨è¡¨å¾å­¦ä¹ é¢†åŸŸä¸€ç›´å‘æŒ¥ç€é‡è¦ä½œç”¨ã€‚å·ç§¯ç¥žç»ç½‘ç»œæž¶æž„ï¼ˆConvNetï¼‰å¯¹è®¡ç®—æœºè§†è§‰ç ”ç©¶äº§ç”Ÿäº†é‡å¤§å½±å“ï¼Œä½¿å¾—å„ç§è§†è§‰è¯†åˆ«ä»»åŠ¡ä¸­èƒ½å¤Ÿä½¿ç”¨é€šç”¨çš„ç‰¹å¾å­¦ä¹ æ–¹æ³•ï¼Œæ— éœ€ä¾èµ–äººå·¥å®žçŽ°çš„ç‰¹å¾å·¥ç¨‹ã€‚è¿‘å¹´æ¥ï¼Œæœ€åˆä¸ºè‡ªç„¶è¯­è¨€å¤„ç†è€Œå¼€å‘çš„ transformer æž¶æž„å› å…¶é€‚ç”¨äºŽä¸åŒè§„æ¨¡çš„æ¨¡åž‹å’Œæ•°æ®é›†ï¼Œåœ¨å…¶ä»–æ·±åº¦å­¦ä¹ é¢†åŸŸä¸­ä¹Ÿå¼€å§‹è¢«å¹¿æ³›ä½¿ç”¨ã€‚
>
> ConvNeXt æž¶æž„çš„å‡ºçŽ°ä½¿ä¼ ç»Ÿçš„ ConvNet æ›´åŠ çŽ°ä»£åŒ–ï¼Œè¯æ˜Žäº†çº¯å·ç§¯æ¨¡åž‹ä¹Ÿå¯ä»¥é€‚åº”æ¨¡åž‹å’Œæ•°æ®é›†çš„è§„æ¨¡å˜åŒ–ã€‚ç„¶è€Œï¼Œè¦æƒ³å¯¹ç¥žç»ç½‘ç»œæž¶æž„çš„è®¾è®¡ç©ºé—´è¿›è¡ŒæŽ¢ç´¢ï¼Œæœ€å¸¸è§æ–¹æ³•ä»ç„¶æ˜¯åœ¨ ImageNet ä¸Šè¿›è¡Œç›‘ç£å­¦ä¹ çš„æ€§èƒ½åŸºå‡†æµ‹è¯•ã€‚`2.3 å›¾åƒåˆ†ç±» & è§†è§‰åŸºç¡€æ¨¡åž‹çš„å‘å±•

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204083251589-803171719.png)




## 2.4 è½»é‡åŒ–å·ç§¯ç¥žç»ç½‘ç»œ

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204083431313-2003936336.png)

### 2.4.1 å·ç§¯çš„å‚æ•°é‡

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204083451975-1836899621.png)

> æ·±åº¦æ¨¡åž‹è½»é‡åŒ–æ–¹æ³•ä¸»è¦åˆ†æˆäº”å¤§ç±»ï¼š
> **ç½‘ç»œå‰ªæž**ã€**ç½‘ç»œé‡åŒ–**ã€**ä½Žç§©åˆ†è§£**ã€**çŸ¥è¯†è’¸é¦**å’Œ**è½»é‡åŒ–ç½‘ç»œè®¾è®¡**ã€‚
>
> - **ç½‘ç»œå‰ªæž**æ˜¯æŒ‡å¯¹è®­ç»ƒå¥½çš„æ¨¡åž‹è¿›è¡Œå‚æ•°åŽ»å†—ä½™ï¼Œå³å‰ªåŽ»è´¡çŒ®è¾ƒå°çš„å‚æ•°ï¼›
> - **ä½Žç§©åˆ†è§£**æ˜¯å°†åŽŸå…ˆç¨ å¯†çš„æ»¡ç§©çŸ©é˜µè¡¨ç¤ºä¸ºè‹¥å¹²ä¸ªä½Žç§©çŸ©é˜µçš„ç»„åˆï¼Œä½Žç§©çŸ©é˜µåˆå¯ä»¥åˆ†è§£ä¸ºå°è§„æ¨¡çŸ©é˜µçš„ä¹˜ç§¯ï¼Œä»Žè€Œç²¾ç®€å·ç§¯è¿‡ç¨‹ï¼›
> - **ç½‘ç»œé‡åŒ–**æ˜¯æŒ‡ä½¿ç”¨ä½æ•°æ›´å°‘çš„æµ®ç‚¹æ•°æ¥å­˜å‚¨ç½‘ç»œå‚æ•°ï¼Œ ä½¿å¾—ç½‘ç»œå ç”¨å­˜å‚¨ç©ºé—´å¾—åˆ°å‡å°‘ï¼Œåœ¨å·¥ç¨‹åº”ç”¨ä¸­è¢«å¹¿æ³›åº”ç”¨ï¼›
> - **çŸ¥è¯†è’¸é¦**ä¹Ÿç§°æ•™å¸ˆ-å­¦ç”Ÿç½‘ç»œï¼Œ æ˜¯å°†ä¸€ä¸ªé¢„å…ˆè®­ç»ƒå¥½çš„æ•™å¸ˆç½‘ç»œä½œä¸ºç›‘ç£ä¿¡å·æ¥è®­ç»ƒä¸€ä¸ªç®€åŒ–çš„å­¦ç”Ÿç½‘ç»œï¼Œä½¿å¾—è½»é‡çº§çš„å­¦ç”Ÿç½‘ç»œèƒ½å¤Ÿè¾¾åˆ°æˆ–æŽ¥è¿‘æ•™å¸ˆç½‘ç»œçš„ç²¾åº¦ã€‚
> - ä»¥ä¸Šå››ç§æ–¹æ³•å‡æ˜¯åŸºäºŽé¢„å…ˆè®­ç»ƒå¥½çš„å¤§ç½‘ç»œï¼Œå¯¹å¤§ç½‘ç»œè¿›è¡Œç²¾ç®€ï¼Œå¦å¤–ä¸€ç§å¸¸è§çš„ç½‘ç»œç®€åŒ–æ–¹æ³•æ˜¯**è½»é‡åŒ–ç½‘ç»œè®¾è®¡**ï¼Œå³ç›´æŽ¥é‡æ–°è®¾è®¡ä¸€ä¸ªç®€åŒ–çš„è½»é‡çº§ç½‘ç»œå¹¶ä»Žå¤´è¿›è¡Œè®­ç»ƒï¼Œè½»é‡åŒ–ç½‘ç»œè®¾è®¡ä¸»è¦é€šè¿‡æ˜¯ä¼˜åŒ–ç½‘ç»œç»“æž„ï¼Œä¼˜åŒ–å·ç§¯æ–¹å¼ç­‰æ–¹æ³•æ¥å‡å°‘å‚æ•°é‡å’Œè®¡ç®—é‡ï¼Œé™ä½Žç½‘ç»œçš„èµ„æºæ¶ˆè€—ï¼Œæå‡è¿è¡Œé€Ÿåº¦ï¼Œå¦‚ä»Šæœ€å¸¸è§çš„è½»é‡çº§ç½‘ç»œä¸»è¦æœ‰è°·æ­Œçš„ MobileNet ç³»åˆ—ï¼Œæ—·ä¸–ç§‘æŠ€çš„ ShuffleNet ç³»åˆ—å’Œ SqueezeNet ç­‰ã€‚
>   ä¸“æ³¨äºŽç›®æ ‡æ£€æµ‹çš„è½»é‡çº§ç½‘ç»œä¸»è¦æ˜¯å°†ç”¨äºŽåˆ†ç±»çš„è½»é‡çº§ç½‘ç»œä½œä¸ºç›®æ ‡æ£€æµ‹ç½‘ç»œçš„éª¨å¹²ç½‘ç»œï¼Œå¯¹äºŽè½»é‡ çº§ç›®æ ‡æ£€æµ‹æœ‰è®¸å¤šè¿›ä¸€æ­¥çš„æ”¹è¿›ï¼Œå¦‚ FGHDetï¼ŒIR-YOLOï¼ŒMTYOLOç­‰

### 2.4.2 å·ç§¯çš„è®¡ç®—é‡(ä¹˜åŠ æ¬¡æ•°)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204083519408-1838076537.png)

> - å¯¹äºŽå·ç§¯å±‚è€Œè¨€ï¼Œå·ç§¯å±‚çš„**å¯å­¦ä¹ å‚æ•°**åŒ…æ‹¬ï¼šå·ç§¯æ ¸+åç½®å€¼ã€‚
> - **å‚æ•°é‡**è®¡ç®—å…¬å¼ï¼š$C^{'}\timesï¼ˆC\times K \times K + 1ï¼‰= C^{'}CK^{2} + C^{'}$
> - å…¶ä¸­$C^{'}$ä¸º$C$é€šé“çš„å·ç§¯æ ¸$K$ä¸ªæ•°
>
> - è¾“å‡ºç‰¹å¾å›¾æ¯ä¸ªé€šé“ä¸Šçš„æ¯ä¸ªå€¼éƒ½æ˜¯è¾“å…¥ç‰¹å¾å›¾å’Œ1ä¸ªCé€šé“çš„å·ç§¯æ ¸è¿›è¡Œå·ç§¯çš„ç»“æžœã€‚
>
> - **ä¹˜åŠ æ¬¡æ•°**è®¡ç®—å…¬å¼:
>
>   $H^{'} \times W^{'} \times C^{'} \times (C \times K \times K) = H^{'}W^{'}C^{'}CK^{2}$.
>   (HxWxCï¼Œåˆ†åˆ«è¡¨ç¤ºé«˜ï¼Œå®½å’Œé€šé“æ•°ã€‚)
>
> - FLOPs = paras * H * W
> - å…¶ä¸­çš„Hå’ŒWåˆ†åˆ«ä¸ºfeature mapçš„å°ºå¯¸ã€‚
> - **åŒºåˆ†FLOPSå’ŒFLOPs**
>   - FLOPS æ³¨æ„**å…¨éƒ¨å¤§å†™** æ˜¯floating point of per secondçš„ç¼©å†™ï¼Œæ„æŒ‡æ¯ç§’æµ®ç‚¹è¿ç®—æ¬¡æ•°ã€‚å¯ä»¥ç†è§£ä¸ºè®¡ç®—é€Ÿåº¦ï¼Œç”¨æ¥è¡¡é‡ç¡¬ä»¶çš„æ€§èƒ½ã€‚
>   - FLOPs æ˜¯floating point of operationsçš„ç¼©å†™ï¼Œæ˜¯æµ®ç‚¹è¿ç®—æ¬¡æ•°ï¼Œç†è§£ä¸ºè®¡ç®—é‡ï¼Œå¯ä»¥ç”¨æ¥è¡¡é‡ç®—æ³•/æ¨¡åž‹å¤æ‚åº¦ã€‚

### 2.4.3 é™ä½Žæ¨¡åž‹å‚æ•°é‡å’Œè®¡ç®—é‡çš„æ–¹æ³•

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204083541545-1611543392.png)

> ç»“åˆä»¥ä¸Šçš„æ¨¡åž‹å‚æ•°é‡å’Œè®¡ç®—é‡è®¡ç®—å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå˜é‡é€šé“æ•°$C^{'}$å’Œ$C$ä»¥åŠå·ç§¯æ ¸å°ºå¯¸$K$æ˜¯ä¸Žå…¶æ­£ç›¸å…³çš„ã€‚ç”±æ­¤ï¼Œè‹¥è¦é™ä½Žæ¨¡åž‹å‚æ•°é‡å’Œè®¡ç®—é‡ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥é€šè¿‡é™ä½Žå…¶å˜é‡ç›¸åº”çš„å€¼æ¥å‡å°‘ã€‚
>
> - é™ä½Žé€šé“æ•°$C^{'}$å’Œ$C$(å¹³æ–¹çº§åˆ«).
> - å‡å°‘å·ç§¯æ ¸çš„å°ºå¯¸$K$(å¹³æ–¹çº§åˆ«)

### 2.4.4 è½»é‡åŒ–ç½‘ç»œè®¾è®¡

ä¸‹é¢æ¥çœ‹ä¸€ä¸‹ï¼Œä¸€äº›å…³äºŽè½»é‡åŒ–ç½‘ç»œçš„è®¾è®¡å®žä¾‹ã€‚

#### 2.4.4.1 GoogLeNet ä½¿ç”¨ä¸åŒå¤§å°çš„å·ç§¯æ ¸

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204083622976-1062281348.png)

> **GoogLeNetçš„åŸºæœ¬æ€è·¯**ï¼šå¹¶ä¸æ˜¯æ‰€æœ‰ç‰¹å¾éƒ½éœ€è¦åŒæ ·å¤§çš„æ„Ÿå—é‡Žï¼Œåœ¨åŒä¸€å±‚ä¸­æ··åˆä½¿ç”¨ä¸åŒå°ºå¯¸çš„ç‰¹å¾å¯ä»¥å‡å°‘å‚æ•°é‡ã€‚

#### 2.4.4.2 ResNet ä½¿ç”¨1Ã—1å·ç§¯åŽ‹ç¼©é€šé“æ•°

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204083637334-946864127.png)

> ä½¿ç”¨$1 \times 1$å·ç§¯ï¼Œç”¨äºŽåŽ‹ç¼©é€šé“ï¼Œé™ä½Žè®¡ç®—å¼€é”€ã€‚

#### 2.4.4.3 å¯åˆ†ç¦»å·ç§¯

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204083709191-787272070.png)

> ä¼ ç»Ÿçš„å·ç§¯ç¥žç»ç½‘ç»œåœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸå·²ç»å–å¾—äº†éžå¸¸å¥½çš„æˆç»©ï¼Œä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€ä¸ªå¾…æ”¹è¿›çš„é—®é¢˜â€”**è®¡ç®—é‡å¤§**ã€‚
>
> å½“å·ç§¯ç¥žç»ç½‘ç»œåº”ç”¨åˆ°å®žé™…å·¥ä¸šåœºæ™¯æ—¶ï¼Œæ¨¡åž‹çš„å‚æ•°é‡å’Œè®¡ç®—é‡éƒ½æ˜¯ååˆ†é‡è¦çš„æŒ‡æ ‡ï¼Œè¾ƒå°çš„æ¨¡åž‹å¯ä»¥é«˜æ•ˆåœ°è¿›è¡Œåˆ†å¸ƒå¼è®­ç»ƒï¼Œå‡å°æ¨¡åž‹æ›´æ–°å¼€é”€ï¼Œé™ä½Žå¹³å°ä½“ç§¯åŠŸè€—å­˜å‚¨å’Œè®¡ç®—èƒ½åŠ›çš„é™åˆ¶ï¼Œæ–¹ä¾¿éƒ¨ç½²åœ¨ç§»åŠ¨ç«¯ã€‚
>
> å› æ­¤ï¼Œä¸ºäº†æ›´å¥½åœ°å®žçŽ°è¿™ä¸ªéœ€æ±‚ï¼Œåœ¨å·ç§¯è¿ç®—çš„åŸºç¡€ä¸Šï¼Œå­¦è€…ä»¬æå‡ºäº†æ›´ä¸ºé«˜æ•ˆçš„å¯åˆ†ç¦»å·ç§¯ã€‚
>
> **å¯åˆ†ç¦»å·ç§¯**ï¼š**ç©ºé—´å¯åˆ†ç¦»å·ç§¯**å’Œ**æ·±åº¦å¯åˆ†ç¦»å·ç§¯**
> ï¼ˆå‡è®¾featureçš„sizeä¸º[channel,height,width])
>
> - **ç©ºé—´**ä¹Ÿå°±æ˜¯æŒ‡ï¼š[height,width]è¿™ä¸¤ä¸ªç»´åº¦ç»„æˆçš„
> - **æ·±åº¦**ä¹Ÿå°±æ˜¯æŒ‡ï¼šchannelè¿™ä¸€ç»´åº¦
>
> - **ç©ºé—´å¯åˆ†ç¦»å·ç§¯**
>   ç©ºé—´å¯åˆ†ç¦»å·ç§¯ï¼šå°†nÃ—nçš„å·ç§¯åˆ†æˆ1Ã—nå’ŒnÃ—1ä¸¤æ­¥è®¡ç®—.
>   - **æ™®é€šçš„3Ã—3å·ç§¯**åœ¨ä¸€ä¸ª5Ã—5çš„feature mapä¸Šçš„è®¡ç®—æ–¹å¼å¦‚ä¸‹å›¾ï¼Œéœ€9Ã—9æ¬¡ä¹˜æ³•ã€‚
>    ![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204151829350-1156886239.png)

>   - **ç©ºé—´å¯åˆ†ç¦»å·ç§¯**è®¡ç®—æ–¹å¼å¦‚ä¸‹å›¾ï¼Œï¼ˆ1ï¼‰å…ˆä½¿ç”¨3Ã—1çš„filterï¼Œæ‰€éœ€è®¡ç®—é‡ä¸º15Ã—3ï¼›ï¼ˆ2ï¼‰ä½¿ç”¨è¿‡1Ã—3çš„filterï¼Œæ‰€éœ€è®¡ç®—é‡ä¸º9Ã—3ï¼›æ€»å…±éœ€è¦72æ¬¡ï¼Œå°äºŽæ™®é€šå·ç§¯çš„81æ¬¡ä¹˜æ³•ã€‚
>     ![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204151839138-1902897477.png)
>     ä»Žå·ç§¯æ¥çœ‹ï¼Œå¯å°†å¸¸è§„å·ç§¯åˆ†è§£ä¸º**é€å±‚å·ç§¯**å’Œ**é€ç‚¹å·ç§¯**ï¼Œé™ä½Žå‚æ•°é‡å’Œè®¡ç®—é‡ã€‚
>
>   - **æ·±åº¦å¯åˆ†ç¦»å·ç§¯**
>
>     - **Conventional Convolution**
>
>     - å‡è®¾è¾“å…¥å±‚ä¸º64Ã—64åƒç´ çš„RGBå›¾åƒã€‚
>       å¸¸è§„å·ç§¯ï¼šæ¯ä¸ªå·ç§¯æ ¸æ˜¯åŒæ—¶æ“ä½œè¾“å…¥å›¾ç‰‡çš„æ¯ä¸ªé€šé“ã€‚
>       å·ç§¯å±‚çš„å‚æ•°æ•°é‡ä¸º4Ã—3Ã—3Ã—3
>       ![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204152356471-1827942482.png)

>     - **Depthwise Convolution**
>
>     - Depthwise Convolutionï¼šä¸€ä¸ªå·ç§¯æ ¸è´Ÿè´£ä¸€ä¸ªé€šé“ï¼Œå·ç§¯æ ¸çš„æ•°é‡ä¸Žä¸Šä¸€å±‚çš„é€šé“æ•°ç›¸åŒï¼ˆé€šé“å’Œå·ç§¯æ ¸ä¸€ä¸€å¯¹åº”ï¼‰ã€‚
>       å·ç§¯å±‚å‚æ•°æ•°é‡ä¸º3Ã—3Ã—3
>       ![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204152408085-1276807398.png)
>       ç¼ºç‚¹ï¼š
>       ï¼ˆ1ï¼‰æ— æ³•æ‰©å±•Feature mapçš„é€šé“æ•°ã€‚
>       ï¼ˆ2ï¼‰æœªæœ‰æ•ˆåˆ©ç”¨ä¸åŒé€šé“åœ¨ç›¸åŒç©ºé—´ä½ç½®ä¸Šçš„featureä¿¡æ¯ã€‚
>
>     - **Pointwise Convolution**
>       Pointwise Convolutionï¼šä¸Žå¸¸è§„å·ç§¯è¿ç®—ç›¸ä¼¼ï¼Œä½†å·ç§¯æ ¸å°ºå¯¸ä¸º 1Ã—1Ã—Mï¼ŒMä¸ºä¸Šä¸€å±‚çš„é€šé“æ•°ã€‚
>       å°†ä¸Šä¸€æ­¥çš„mapåœ¨æ·±åº¦æ–¹å‘ä¸Šè¿›è¡ŒåŠ æƒç»„åˆï¼Œç”Ÿæˆæ–°çš„Feature mapã€‚æœ‰å‡ ä¸ªå·ç§¯æ ¸å°±æœ‰å‡ ä¸ªè¾“å‡ºFeature mapã€‚
>       å·ç§¯å±‚å‚æ•°æ•°é‡ä¸º1Ã—1Ã—3Ã—4
>       ![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204152432570-392717352.png)


#### 2.4.4.4 MobileNet V1/V2/V3 (2017~2019)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204083750868-1553719021.png)

> - **MobilenetV1**
>   è®ºæ–‡åœ°å€ï¼š[1704.04861.pdf (arxiv.org)](https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/1704.04861.pdf)
>
>   - å¼•å…¥äº†æ·±åº¦å¯åˆ†ç¦»å·ç§¯
>   - ç›´ç­’ç»“æž„ï¼ˆç½‘ç»œç»“æž„ï¼‰
>
>   MobileNetV1ç½‘ç»œä¸»è¦æ€è·¯å°±æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å †å ã€‚
>
> - **MobilenetV2**
>
>   è®ºæ–‡åœ°å€ï¼š[[1801.04381\] MobileNetV2: Inverted Residuals and Linear Bottlenecks (arxiv.org)](https://link.zhihu.com/?target=https%3A//arxiv.org/abs/1801.04381)
>
>   ä¸Šå›¾ä¸­ï¼ŒMobilenetV2 unitåŒ…å«stride=1å’Œstride=2ä¸¤ç§ã€‚
>
>   - å¼•å…¥äº†bottleneckç»“æž„ã€‚
>   - å°†bottleneckç»“æž„å˜æˆäº†çººé”¤åž‹ï¼Œå³resnetæ˜¯å…ˆç¼©å°ä¸ºåŽŸæ¥çš„1/4ï¼Œå†æ”¾å¤§ï¼Œä»–æ˜¯æ”¾å¤§åˆ°åŽŸæ¥çš„6å€ï¼Œå†ç¼©å°ã€‚
>   - å¹¶ä¸”åŽ»æŽ‰äº†Residual Blockæœ€åŽçš„ReLU
>
> - **MobilenetV3**
>
>   è®ºæ–‡åœ°å€ï¼š[https://arxiv.org/abs/1905.0224](https://link.zhihu.com/?target=https%3A//arxiv.org/abs/1905.02244)ä¸Šå›¾ä¸­ï¼ŒMobilenetV3 unitåŒ…å«stride=1å’Œstride=2ä¸¤ç§ã€‚
>
>   - å¼•å…¥SEç»“æž„
>   - ä¿®æ”¹ç½‘ç»œå°¾éƒ¨ç»“æž„
>   - ä¿®æ”¹channelæ•°é‡
>   - éžçº¿æ€§å˜æ¢çš„æ”¹å˜

#### 2.4.4.5 ResNeXt ä¸­çš„åˆ†ç»„å·ç§¯

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084052358-1561041849.png)

> **ResNeXt**æ˜¯**ResNet**å’Œ**Inception**çš„ç»“åˆä½“ï¼Œä¸åŒäºŽInception v4çš„æ˜¯ï¼ŒResNextä¸éœ€è¦äººå·¥è®¾è®¡å¤æ‚çš„Inceptionç»“æž„ç»†èŠ‚ï¼Œè€Œæ˜¯æ¯ä¸€ä¸ªåˆ†æ”¯éƒ½é‡‡ç”¨ç›¸åŒçš„æ‹“æ‰‘ç»“æž„ã€‚ResNeXtçš„æœ¬è´¨æ˜¯åˆ†ç»„å·ç§¯ï¼Œé€šè¿‡å˜é‡**åŸºæ•°ï¼ˆCardinalityï¼‰**æ¥æŽ§åˆ¶ç»„çš„æ•°é‡ã€‚
>
> - ResNeXtå°†ResNetçš„bottleneck blockä¸­$3 \times 3$çš„å·ç§¯æ”¹ä¸ºåˆ†ç»„å·ç§¯ï¼Œé™ä½Žæ¨¡åž‹è®¡ç®—é‡ã€‚
> - å¯åˆ†ç¦»å·ç§¯ä¸ºåˆ†ç»„å·ç§¯çš„ç‰¹æ®Šæƒ…å½¢ï¼Œç»„æ•°=é€šé“æ•°

## 2.5 Vision Transformers

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084111729-1423476467.png)

### 2.5.1 æ³¨æ„åŠ›æœºåˆ¶ Attention Mechanism

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084131913-700569441.png)

> **å®žçŽ°å±‚æ¬¡åŒ–ç‰¹å¾**ï¼š 
>
> - **åŽå±‚ç‰¹å¾**æ˜¯ç©ºé—´é‚»åŸŸå†…çš„**å‰å±‚ç‰¹å¾**çš„åŠ æƒæ±‚å’Œ
>   **æƒé‡è¶Šå¤§**ï¼Œå¯¹åº”ä½ç½®çš„**ç‰¹å¾å°±è¶Šé‡è¦**
>
> - åœ¨ä¼ ç»Ÿå·ç§¯ä¸­ï¼Œå·ç§¯æ˜¯å¯å­¦ä¹ çš„å‚æ•°ï¼Œä½†ä¸Žè¾“å…¥æ— å…³ï¼Œåªèƒ½å»ºæ¨¡å±€éƒ¨å…³ç³»ï¼Œè¿œè·ç¦»å…³ç³»åªèƒ½é€šè¿‡å¤šå±‚å·ç§¯å®žçŽ°ã€‚
> - **å¼•å…¥æ³¨æ„åŠ›æœºåˆ¶åŽ**ï¼Œæƒé‡å¯ä»¥æ˜¯è¾“å…¥çš„å‡½æ•°ï¼Œ
>   å¯ä»¥ä¸å±€é™äºŽé‚»åŸŸï¼Œæ˜¾å¼å»ºæ¨¡è¿œè·ç¦»å…³ç³»ã€‚

### 2.5.2  Why Attention

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084152996-1678163080.png)

> åœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸï¼Œæ¨¡åž‹å¾€å¾€éœ€è¦æŽ¥æ”¶å’Œå¤„ç†å¤§é‡çš„æ•°æ®ï¼Œç„¶è€Œåœ¨ç‰¹å®šçš„æŸä¸ªæ—¶åˆ»ï¼Œå¾€å¾€åªæœ‰å°‘éƒ¨åˆ†çš„æŸäº›æ•°æ®æ˜¯é‡è¦çš„ï¼Œè¿™ç§æƒ…å†µå°±éžå¸¸é€‚åˆ**Attentionæœºåˆ¶**å‘å…‰å‘çƒ­ã€‚
>
> ä¸¾ä¸ªä¾‹å­ï¼Œä¸Šå›¾å±•ç¤ºäº†ä¸€ä¸ªæœºå™¨ç¿»è¯‘çš„ç»“æžœï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³å°†"who are you"ç¿»è¯‘ä¸º"ä½ æ˜¯è°"ï¼Œä¼ ç»Ÿçš„æ¨¡åž‹å¤„ç†æ–¹å¼æ˜¯ä¸€ä¸ªseq-to-seqçš„æ¨¡åž‹ï¼Œå…¶åŒ…å«ä¸€ä¸ªencoderç«¯å’Œä¸€ä¸ªdecoderç«¯ï¼Œå…¶ä¸­encoderç«¯å¯¹"who are you"è¿›è¡Œç¼–ç ï¼Œç„¶åŽå°†æ•´å¥è¯çš„ä¿¡æ¯ä¼ é€’ç»™decoderç«¯ï¼Œç”±decoderè§£ç å‡º"æˆ‘æ˜¯è°"ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œdecoderæ˜¯é€å­—è§£ç çš„ï¼Œåœ¨æ¯æ¬¡è§£ç çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æžœæŽ¥æ”¶ä¿¡æ¯è¿‡å¤šï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¨¡åž‹çš„å†…éƒ¨æ··ä¹±ï¼Œä»Žè€Œå¯¼è‡´é”™è¯¯ç»“æžœçš„å‡ºçŽ°ã€‚

### 2.5.3 å®žçŽ° Attention

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084209593-188429425.png)

> - input, output, query, key, value å‡ä¸º 3D ç‰¹å¾å›¾ï¼Œç‰¹å¾ç»´åº¦æœªç”»å‡º
> - $W_{key}$, $ð‘Š_{query}$, $ð‘Š_{value}$æ˜¯å¯å­¦ä¹ å‚æ•°ï¼Œå¯ç”±1Ã—1çš„å·ç§¯å®žçŽ°
> - query å’Œ key, value å¦‚æžœå‡ºè‡ªåŒä¸€ä¸ªç‰¹å¾å›¾åˆ™ç§°ä¸º**è‡ªæ³¨æ„åŠ›**

### 2.5.4 Attentionåº”ç”¨

#### 2.5.4.1 å¤šå¤´æ³¨æ„åŠ› Multi-head (Self-)Attention

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084223674-1232342548.png)

> ä½¿ç”¨ä¸åŒå‚æ•°çš„æ³¨æ„åŠ›å¤´äº§ç”Ÿå¤šç»„ç‰¹å¾ï¼Œæ²¿é€šé“ç»´åº¦æ‹¼æŽ¥å¾—åˆ°æœ€ç»ˆç‰¹å¾ï¼Œä»Žè€Œæž„æˆTransformer Encoder çš„æ ¸å¿ƒæ¨¡å—

#### 2.5.4.2 1D æ•°æ®ä¸Šçš„ Attention

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084243582-908275761.png)

> è¾“å…¥ç‰¹å¾åºåˆ—->è‡ªæ³¨æ„åŠ›å±‚->è¾“å‡ºç‰¹å¾åºåˆ—ã€‚

#### 2.5.4.3 Vision Transformer (2020)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084307761-622877897.png)

> - å°†å›¾åƒåˆ‡åˆ†æˆè‹¥å¹² 16Ã—16 çš„å°å—ï¼Œå½“ä½œä¸€åˆ—"è¯å‘é‡"ï¼Œç»å¤šå±‚ Transformer Encoder å˜æ¢äº§ç”Ÿç‰¹å¾
> -  å›¾å—ä¹‹å¤–åŠ å…¥é¢å¤–çš„ tokenï¼Œç”¨äºŽ query å…¶ä»– patch çš„ç‰¹å¾å¹¶ç»™å‡ºæœ€åŽåˆ†ç±»
> - æ³¨æ„åŠ›æ¨¡å—åŸºäºŽå…¨å±€æ„Ÿå—é‡Žï¼Œå¤æ‚åº¦ä¸ºå°ºå¯¸çš„ 4 æ¬¡æ–¹


#### 2.5.4.4 Swin Transformer (ICCV 2021 best paper)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084326677-1033704300.png)

> - Vision Transformer çš„ç‰¹å¾å›¾æ˜¯æ˜¯ç›´æŽ¥ä¸‹é‡‡æ · 16 å€
>   å¾—åˆ°çš„ï¼ŒåŽé¢çš„ç‰¹å¾å›¾ä¹Ÿæ˜¯ç»´æŒè¿™ä¸ªä¸‹é‡‡æ ·çŽ‡ä¸å˜ï¼Œ
>   ç¼ºå°‘äº†ä¼ ç»Ÿå·ç§¯ç¥žç»ç½‘ç»œé‡Œä¸åŒå°ºå¯¸ç‰¹å¾å›¾çš„å±‚æ¬¡åŒ–
>   ç»“æž„ã€‚æ‰€ä»¥ï¼ŒSwin Transformer æå‡ºäº†åˆ†å±‚ç»“æž„
>   ï¼ˆé‡‘å­—å¡”ç»“æž„ï¼‰Hierarchical Transformerã€‚
>
> - åŒæ—¶ï¼Œç›¸å¯¹äºŽ Vision Transformer ä¸­ç›´æŽ¥å¯¹æ•´ä¸ªç‰¹å¾
>   å›¾è¿›è¡Œ Multi-Head Self-Attentionï¼ŒSwin
>   Transformer å°†ç‰¹å¾å›¾åˆ’åˆ†æˆäº†å¤šä¸ªä¸ç›¸äº¤çš„åŒºåŸŸ
>   ï¼ˆWindowï¼‰ï¼Œå°† Multi-Head Self-Attention è®¡ç®—
>   é™åˆ¶åœ¨çª—å£å†…ï¼Œè¿™æ ·èƒ½å¤Ÿå‡å°‘è®¡ç®—é‡çš„ï¼Œå°¤å…¶æ˜¯åœ¨æµ…
>   å±‚ç‰¹å¾å›¾å¾ˆå¤§çš„æ—¶å€™ã€‚

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084340516-962900095.png)

> - ç”±äºŽå°† Multi-Head Self-Attention è®¡ç®—é™åˆ¶åœ¨çª—å£å†…ï¼Œçª—å£ä¸Žçª—å£ä¹‹é—´æ— æ³•è¿›è¡Œä¿¡æ¯ä¼ é€’ã€‚æ‰€ä»¥ï¼Œ Swin Transformer åˆæå‡ºäº† Shifted Windows Multi-Head Self-Attention (SW-MSA) çš„æ¦‚å¿µï¼Œå³ç¬¬ ð‘™ + 1 å±‚çš„çª—å£åˆ†åˆ«å‘å³ä¾§å’Œä¸‹æ–¹å„åç§»äº†åŠä¸ªçª—å£çš„ä½ç½®ã€‚é‚£ä¹ˆï¼Œè¿™å°±è®©ä¿¡æ¯èƒ½å¤Ÿè·¨çª—å£ä¼ é€’ã€‚

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084350392-1946343751.png)

> - é€šè¿‡ 4 ä¸ª Stage æž„å»ºä¸åŒå¤§å°çš„ç‰¹å¾å›¾
> -  é‡å¤å †å  Swin Transformer Blockï¼šè¿™é‡Œçš„ Block æœ‰ä¸¤ç§ç»“æž„ï¼Œå¦‚å›¾ (b) ï¼Œä¸€ä¸ªä½¿ç”¨äº† W-MSA ç»“
>   æž„ï¼Œä¸€ä¸ªä½¿ç”¨äº† SW-MSA ç»“æž„ã€‚è¿™ä¸¤ä¸ªç»“æž„æˆå¯¹ä½¿ç”¨ï¼Œæ‰€ä»¥å †å  Swin Transformer Block çš„ä¸ªæ•°
>   éƒ½æ˜¯å¶æ•°ã€‚

# 3.æ¨¡åž‹å­¦ä¹ 

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084428371-1727241619.png)

## 3.1 æ¨¡åž‹å­¦ä¹ çš„èŒƒå¼

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084445203-1230830114.png)

> æˆ‘ä»¬ä½¿ç”¨æ¨¡åž‹å­¦ä¹ çš„ç›®æ ‡æ˜¯ï¼Œç¡®å®šæ¨¡åž‹$F_{\Theta}$çš„å…·ä½“å½¢å¼åŽï¼Œæ‰¾å¯»æœ€ä¼˜å‚æ•°$\Theta^{*}$ ï¼Œä½¿å¾—æ¨¡åž‹$F_{\Theta^{*}}(X)$ç»™å‡ºå‡†ç¡®çš„åˆ†ç±»ç»“æžœ$P(y|X)$.
>
> å®žçŽ°æ¨¡åž‹å­¦ä¹ çš„èŒƒå¼æœ‰ä¸¤ç§ï¼š
>
> - èŒƒå¼ä¸€ï¼šç›‘ç£å­¦ä¹ 
> - èŒƒå¼äºŒï¼šè‡ªç›‘ç£å­¦ä¹ 

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084454101-2005714115.png)




## 3.2 ç›‘ç£å­¦ä¹ 

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084613731-852324323.png)

### 3.2.1 ç›‘ç£å­¦ä¹ ä»‹ç»

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084624551-920151058.png)

> ç›‘ç£å­¦ä¹ æ˜¯ä½¿ç”¨å·²çŸ¥æ­£ç¡®ç­”æ¡ˆçš„ç¤ºä¾‹æ¥è®­ç»ƒç½‘ç»œï¼Œæ¯ç»„è®­ç»ƒæ•°æ®æœ‰ä¸€ä¸ªæ˜Žç¡®çš„æ ‡è¯†æˆ–ç»“æžœã€‚ å¯ä»¥è®­ç»ƒä¸€ä¸ªç½‘ç»œï¼Œè®©å…¶ä»Žæ•°æ®é›†ä¸­è¯†åˆ«å‡ºå¯¹è±¡çš„ç…§ç‰‡ã€‚ä»¥ä¸‹å°±æ˜¯åœ¨è¿™ä¸ªå‡è®¾åœºæ™¯ä¸­æ‰€è¦é‡‡å–çš„æ­¥éª¤ã€‚
>
> -  step1ï¼šæ•°æ®é›†çš„åˆ›å»ºå’Œåˆ†ç±»
> -  step2ï¼šæ•°æ®å¢žå¼º
> -  step3ï¼šç‰¹å¾å·¥ç¨‹
> -  step4ï¼šæž„å»ºé¢„æµ‹æ¨¡åž‹å’ŒæŸå¤±
> -  step5ï¼šè®­ç»ƒ
> -  step6ï¼šéªŒè¯å’Œæ¨¡åž‹é€‰æ‹©
> -  step7ï¼šæµ‹è¯•åŠåº”ç”¨x xx

### 3.2.2 äº¤å‰ç†µæŸå¤± Cross-Entropy Loss

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084647516-1749154065.png)

> **äº¤å‰ç†µï¼ˆCross Entropyï¼‰**æ˜¯Shannonä¿¡æ¯è®ºä¸­ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œä¸»è¦ç”¨äºŽåº¦é‡ä¸¤ä¸ªæ¦‚çŽ‡åˆ†å¸ƒé—´çš„å·®å¼‚æ€§ä¿¡æ¯ã€‚åœ¨ä¿¡æ¯è®ºä¸­ï¼Œäº¤å‰ç†µæ˜¯è¡¨ç¤ºä¸¤ä¸ªæ¦‚çŽ‡åˆ†å¸ƒ$p$,$q$çš„å·®å¼‚ï¼Œå…¶ä¸­ $p$è¡¨ç¤ºçœŸå®žåˆ†å¸ƒï¼Œ$q$è¡¨ç¤ºé¢„æµ‹åˆ†å¸ƒï¼Œé‚£ä¹ˆ$H(p.q)$å°±ç§°ä¸ºäº¤å‰ç†µï¼š
> $$
> H(p, q) = \sum_{i}p_{i} \cdot ln\frac{1}{q_{i}} = \sum_{i} ln_{q_{i}}
> $$
> äº¤å‰ç†µå¯åœ¨ç¥žç»ç½‘ç»œä¸­ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œ$p$è¡¨ç¤ºçœŸå®žæ ‡è®°çš„åˆ†å¸ƒï¼Œ$q$åˆ™ä¸ºè®­ç»ƒåŽçš„æ¨¡åž‹çš„é¢„æµ‹æ ‡è®°åˆ†å¸ƒï¼Œäº¤å‰ç†µæŸå¤±å‡½æ•°å¯ä»¥è¡¡é‡ $p$ä¸Ž$q$çš„ç›¸ä¼¼æ€§ã€‚
>
> **äº¤å‰ç†µå‡½æ•°å¸¸ç”¨äºŽé€»è¾‘å›žå½’(logistic regression)ï¼Œä¹Ÿå°±æ˜¯åˆ†ç±»(classification)ã€‚**

### 3.2.3 ä¼˜åŒ–ç›®æ ‡ & éšæœºæ¢¯åº¦ä¸‹é™

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084711184-307460384.png)



### 3.2.4 åŠ¨é‡ Momentum SGD

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084753458-1781940545.png)



### 3.2.5 åŸºäºŽæ¢¯åº¦ä¸‹é™è®­ç»ƒç¥žç»ç½‘ç»œçš„æ•´ä½“æµç¨‹

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084808109-1172774763.png)

> 

### 3.2.6 è®­ç»ƒæŠ€å·§çš„é‡è¦æ€§

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204084821971-98108527.png)

> **Tricksè®­ç»ƒæŠ€å·§**
> å¯ä»¥ä»Žä¸Šé¢è¿™å¼ è¡¨çš„å¯¹æ¯”æ•°æ®çœ‹å‡ºï¼Œè®­ç»ƒæŠ€å·§çš„é‡è¦æ€§ã€‚
>
> ä¸‹é¢æ˜¯ä¸€äº›è®­ç»ƒæŠ€å·§çš„æ€»ç»“ï¼š
>
> - Tips and tricks for Neural Networks: https://towardsdatascience.com/tips-and-tricks-for-neural-networks-63876e3aad1a
>
> - Tips For Using Dropout: https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/
>
> - æ·±åº¦ç¥žç»ç½‘ç»œæ¨¡åž‹è®­ç»ƒä¸­çš„ tricksï¼ˆåŽŸç†ä¸Žä»£ç æ±‡æ€»ï¼‰ï¼šhttps://mp.weixin.qq.com/s/qw1mDd1Nt1kfU0Eh_0dPGQ
>   Tips and tricks for Neural Networks æ·±åº¦å­¦ä¹ è®­ç»ƒç¥žç»ç½‘ç»œçš„æŠ€å·§æ€»ç»“ï¼ˆä¸å®šæœŸæ›´æ–°ï¼‰
>   https://blog.51cto.com/u_11466419/5508205

## 3.3 å­¦ä¹ çŽ‡ä¸Žä¼˜åŒ–å™¨ç­–ç•¥

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204085109161-1173546884.png)

### 3.3.1  æƒé‡åˆå§‹åŒ–

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204090950868-1284129537.png)

> é’ˆå¯¹å·ç§¯å±‚å’Œå…¨è¿žæŽ¥å±‚ï¼Œåˆå§‹åŒ–è¿žæŽ¥æƒé‡$W$å’Œåç½®$b$.
>
> - **éšæœºåˆå§‹åŒ–**
>   - 1.æœ´ç´ æ–¹æ³•
>   - 2.Xavieræ–¹æ³•
>   - 3.Kaimingæ–¹æ³•
> - **ç”¨è®­ç»ƒå¥½çš„æ¨¡åž‹è¿›è¡Œæƒé‡åˆå§‹åŒ–**
>   - æ›¿æ¢é¢„è®­ç»ƒæ¨¡åž‹çš„åˆ†ç±»å¤´ï¼Œè¿›è¡Œå¾®è°ƒè®­ç»ƒ(finetune)ã€‚

### 3.3.2 å­¦ä¹ çŽ‡å¯¹è®­ç»ƒçš„å½±å“

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091008435-829039342.png)

> å­¦ä¹ çŽ‡å‚æ•°åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‡ºçŽ°çš„æƒ…å†µæœ‰ï¼š**å­¦ä¹ çŽ‡è¿‡ä½Žã€å­¦ä¹ çŽ‡åˆé€‚ã€å­¦ä¹ çŽ‡åé«˜ã€å­¦ä¹ çŽ‡è¿‡é«˜**ã€‚
> ä¸Šå›¾æ˜¯ç›¸åº”æƒ…å†µçš„æ›²çº¿å›¾ã€‚
>
> - å¦å¤–éœ€è¦è€ƒè™‘çš„æ˜¯ï¼Œåœ¨è°ƒæ•´å’Œè®¾ç½®å­¦ä¹ çŽ‡æ—¶ï¼Œè¦è€ƒè™‘è®­ç»ƒçš„æ–¹å¼å’Œç­–ç•¥ï¼š
>   - ä»Žå¤´è®­ç»ƒå¯ä½¿ç”¨è¾ƒå¤§çš„å­¦ä¹ çŽ‡ï¼Œä¾‹å¦‚ 0.01~0.1
>   - å¾®è°ƒé€šå¸¸ä½¿ç”¨è¾ƒå°å­¦ä¹ çŽ‡ï¼Œä¾‹å¦‚ 0.001~0.01

### 3.3.3 å­¦ä¹ çŽ‡ç­–ç•¥

#### 3.3.3.1 å­¦ä¹ çŽ‡ç­–ç•¥ï¼šå­¦ä¹ çŽ‡é€€ç« Annealing

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091034001-1109871748.png)

> åœ¨è®­ç»ƒç¥žç»ç½‘ç»œæ—¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å­¦ä¹ çŽ‡éƒ½ä¼šéšç€è®­ç»ƒè€Œå˜åŒ–ï¼Œè¿™ä¸»è¦æ˜¯ç”±äºŽï¼Œåœ¨ç¥žç»ç½‘ç»œè®­ç»ƒçš„åŽæœŸï¼Œå¦‚æžœå­¦ä¹ çŽ‡è¿‡é«˜ï¼Œä¼šé€ æˆlossçš„æŒ¯è¡ï¼Œä½†æ˜¯å¦‚æžœå­¦ä¹ çŽ‡å‡å°çš„è¿‡å¿«ï¼Œåˆä¼šé€ æˆæ”¶æ•›å˜æ…¢çš„æƒ…å†µã€‚
> å› æ­¤ï¼Œå¦‚ä½•è°ƒæ•´å­¦ä¹ çŽ‡ä¹Ÿæ˜¯ä¸€ä¸ªå€¼å¾—è®¨è®ºçš„é—®é¢˜ã€‚ç›®å‰ï¼Œæ¯”è¾ƒå¸¸è§çš„å­¦ä¹ çŽ‡é€€ç«æ–¹å¼æœ‰å¦‚ä¸‹å‡ ç§ï¼š
>
> - æŒ‰æ­¥é•¿ä¸‹é™
> - æŒ‰æ¯”ä¾‹ä¸‹é™
> - æŒ‰å€’æ•°ä¸‹é™
> - æŒ‰ä½™å¼¦å‡½æ•°ä¸‹é™

#### 3.3.3.2 å­¦ä¹ çŽ‡ç­–ç•¥ï¼šå­¦ä¹ çŽ‡é¢„çƒ­ Warmup

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091051212-989903303.png)

> - åœ¨mini-batch æ¢¯åº¦ä¸‹é™æ–¹æ³•ä¸­ï¼Œå¦‚æžœbatchæ¯”è¾ƒå¤§çš„è¯ï¼Œé€šå¸¸éœ€è¦æ¯”è¾ƒå¤§çš„å­¦ä¹ çŽ‡
> - ä½†åœ¨ä¸€å¼€å§‹çš„è®­ç»ƒä¸­ï¼Œç”±äºŽå‚æ•°æ˜¯éšæœºåˆå§‹åŒ–çš„ï¼Œæ‰€ä»¥æ­¤æ—¶çš„æ¢¯åº¦å¾€å¾€ä¹Ÿå¾ˆå¤§
>   å¦‚æžœæ­¤æ—¶å­¦ä¹ çŽ‡ä¹Ÿå¾ˆå¤§çš„è¯ï¼Œè®­ç»ƒå°†å˜å¾—å¾ˆä¸ç¨³å®š
> - â€”â€”ä¸ºäº†æé«˜è®­ç»ƒçš„ç¨³å®šæ€§ï¼Œæˆ‘ä»¬åœ¨æœ€åˆå‡ è½®è¿­ä»£æ—¶ï¼Œé‡‡ç”¨è¾ƒå°çš„å­¦ä¹ çŽ‡ï¼Œç­‰æ¢¯åº¦ä¸‹é™åˆ°ä¸€å®šç¨‹åº¦ä¹‹åŽï¼Œå†æ¢å¤åˆ°åˆå§‹çš„å­¦ä¹ çŽ‡
>   - è¿™ç§æ–¹æ³•ç§°ä¸º**å­¦ä¹ çŽ‡é¢„çƒ­ learning rate warmup**
>   - å½“é¢„çƒ­è¿‡ç¨‹ç»“æŸçš„æ—¶å€™ï¼Œå†é€‰æ‹©ä¸€ç§å­¦ä¹ çŽ‡è¡°å‡çš„æ–¹å¼æ¥é™ä½Žå­¦ä¹ çŽ‡

#### 3.3.3.3 Linear Scaling Ruleçº¿æ€§ç¼©æ”¾åŽŸåˆ™

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091114587-1162663687.png)

> learning rateçš„è®¾ç½®åº”å’Œbatch_sizeçš„è®¾ç½®æˆæ­£æ¯”ï¼Œå³æ‰€è°“çš„**çº¿æ€§ç¼©æ”¾åŽŸåˆ™ï¼ˆlinear scaling ruleï¼‰ã€‚**
>
> - **ç»éªŒæ€§ç»“è®º**ï¼šé’ˆå¯¹åŒä¸€ä¸ªè®­ç»ƒä»»åŠ¡ï¼Œå½“ batch size æ‰©å¤§ä¸ºåŽŸæ¥çš„ ð‘˜ å€æ—¶ï¼Œå­¦ä¹ çŽ‡ä¹Ÿåº”å¯¹åº”æ‰©å¤§ ð‘˜ å€
> - **ç›´è§‚ç†è§£**ï¼šè¿™æ ·åšå¯ä»¥ä¿è¯å¹³å‡æ¯ä¸ªæ ·æœ¬å¸¦æ¥çš„æ¢¯åº¦ä¸‹é™æ­¥é•¿ç›¸åŒ

#### 3.3.3.4 è‡ªé€‚åº”æ¢¯åº¦ç®—æ³•

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091155881-670179429.png)

> è‡ªé€‚åº”æ¢¯åº¦ç®—æ³•çš„åŸºæœ¬æ€è·¯æ˜¯,ä¸åŒçš„å‚æ•°éœ€è¦ä¸åŒçš„å­¦ä¹ çŽ‡,æ ¹æ®æ¢¯åº¦çš„åŽ†å²å¹…åº¦è‡ªåŠ¨è°ƒæ•´å­¦ä¹ çŽ‡ã€‚
>
> å°½ç®¡è‡ªé€‚åº”æ¢¯åº¦ç®—æ³•çš„æ”¶æ•›é€Ÿåº¦æ›´å¿«ï¼Œä½†å…¶æ³›åŒ–æ€§èƒ½å´æ¯”SGDç®—æ³•å·®ã€‚å…·ä½“æ¥è¯´ï¼Œè‡ªé€‚åº”æ¢¯åº¦ç®—æ³•åœ¨è®­ç»ƒé˜¶æ®µçš„è¿›å±•å¾ˆå¿«ï¼Œä½†åœ¨æµ‹è¯•æ•°æ®ä¸Šçš„è¡¨çŽ°å¾ˆå¿«å°±ä¼šåœæ»žä¸å‰ã€‚ä½†æ˜¯SGDé€šå¸¸å¯¹æ¨¡åž‹æ€§èƒ½çš„æ”¹å–„å¾ˆæ…¢ï¼Œä½†å¯ä»¥èŽ·å¾—æ›´é«˜çš„æµ‹è¯•æ€§èƒ½ã€‚å¯¹äºŽè¿™ç§æ³›åŒ–å·®è·çš„ä¸€ç§ç»éªŒè§£é‡Šæ˜¯ï¼Œè‡ªé€‚åº”æ¢¯åº¦ç®—æ³•å€¾å‘äºŽæ”¶æ•›åˆ°å°–é”çš„æžå°å€¼ï¼Œå…¶å±€éƒ¨åœ°åŒºçš„æ›²çŽ‡è¾ƒå¤§ï¼Œæ‰€ä»¥æ³›åŒ–æ€§èƒ½è¾ƒå·®ï¼Œè€ŒSGDåˆ™å€¾å‘äºŽå¯»æ‰¾å¹³å¦çš„æžå°å€¼ï¼Œå› æ­¤æ³›åŒ–è¾ƒå¥½ã€‚

## 3.4 æ­£åˆ™åŒ–ä¸Žæƒé‡è¡°å‡ Weight Decay

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091218355-2146688331.png)

> æƒé‡è¡°å‡weight decayï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªè§„èŒƒçš„å®šä¹‰ï¼Œè€Œåªæ˜¯ä¿—ç§°è€Œå·²ï¼Œå¯ä»¥ç†è§£ä¸ºå‰Šå‡/æƒ©ç½šæƒé‡ã€‚ä»Žè¿™ä¸ªè§’åº¦çœ‹ï¼Œä¸è®ºä½ ç”¨ä»€ä¹ˆæ­£åˆ™åŒ–æ–¹æ³•ï¼Œåªè¦ç›¸å½“äºŽå‰Šå‡äº†æƒé‡ï¼Œé‚£éƒ½å¯ä»¥ç§°ä¸º$weight dacay$ã€‚
> **å¦‚æžœè¦ç»™ä¸ªå®šä¹‰ï¼Œç®€å•åœ°æ›´æ–°æƒé‡ï¼Œå¹¶æ¯æ¬¡ä»Žæƒé‡ä¸­å†å‡åŽ»ä¸€ç‚¹ï¼Œå½¢å¦‚ä¸‹å¼ï¼Œå°±å«æƒé‡è¡°å‡ï¼š**
>
> ä¸è®¾$dacay$æ—¶ï¼Œè¿­ä»£æ—¶å‚æ•°çš„æ›´æ–°è¿‡ç¨‹å¯ä»¥è¡¨ç¤ºä¸ºï¼š
> $$
> p= p - lrÃ—d_p
> $$
> å¢žåŠ $weight_dacay$å‚æ•°åŽè¡¨ç¤ºä¸ºï¼š
> $$
> p = p - lr Ã—(d_p + p Ã— dacay)
> $$
> è¿™ä¸ª$p$å°±å«**è¡°å‡çŽ‡**ã€‚

## 3.5 æ—©åœ Early Stopping

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091241424-937628925.png)

> æ—©æœŸåœæ­¢æ˜¯é˜²æ­¢ç¥žç»ç½‘ç»œåœ¨è®­ç»ƒæ—¶å¯¹æ•°æ®è¿‡æ‹Ÿåˆçš„å¦ä¸€ç§æœºåˆ¶ã€‚å½“æˆ‘ä»¬çœ‹åˆ°è®­ç»ƒå’ŒéªŒè¯æŸå¤±å›¾å¼€å§‹å‘æ•£æ—¶ï¼Œå°±ç»ˆæ­¢è®­ç»ƒã€‚è¿™é€šå¸¸åœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¸‹è¿›è¡Œ:
>
> 1. æˆ‘ä»¬éžå¸¸ç¡®å®šæ¨¡åž‹å¼€å§‹è¿‡æ‹Ÿåˆã€‚
> 2. æˆ‘ä»¬ä¹Ÿç¡®ä¿¡ï¼Œé™ä½Žå­¦ä¹ çŽ‡å’Œå¢žåŠ è®­ç»ƒå¯¹æ¨¡åž‹æ²¡æœ‰å¸®åŠ©ã€‚
>
> è¿™å®žé™…ä¸Šå–å†³äºŽæœºå™¨å­¦ä¹ ç ”ç©¶äººå‘˜å¦‚ä½•ä½¿ç”¨è¿™ä¸¤è€…ã€‚åœ¨éžå¸¸å¤§çš„æ•°æ®é›†ä¸Šè®­ç»ƒå¤§åž‹æ·±åº¦å­¦ä¹ ç¥žç»ç½‘ç»œæ—¶ï¼Œ**æ›´å¸¸ç”¨çš„æ˜¯ä½¿ç”¨å­¦ä¹ çŽ‡è°ƒæ•´**ï¼Œä½¿æˆ‘ä»¬éžå¸¸ç¡®å®šç¥žç»ç½‘ç»œå·²ç»è¾¾åˆ°æœ€ä¼˜è§£ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä¸å†æ·±å…¥è®¨è®ºæ›´å¤šçš„ç†è®ºç»†èŠ‚ã€‚

## 3.6 æ¨¡åž‹æƒé‡å¤„ç†

### 3.6.1 æ¨¡åž‹æƒé‡å¹³å‡ EMA

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091319255-414227892.png)

> ä¸€å¥è¯æ€»ç»“**æƒé‡æ»‘åŠ¨å¹³å‡ï¼ˆExponential Moving Averageï¼‰**å°±æ˜¯ï¼šCopyä¸€ä»½æ¨¡åž‹æ‰€æœ‰æƒé‡ï¼ˆè®°ä¸º$Weights$ï¼‰çš„å¤‡ä»½ï¼ˆè®°ä¸º$EMA_{weights}$ï¼‰ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­æ¯æ¬¡æ›´æ–°æƒé‡æ—¶åŒæ—¶ä¹Ÿå¯¹$EMA_{weights}$è¿›è¡Œæ»‘åŠ¨å¹³å‡æ›´æ–°ï¼Œè®­ç»ƒé˜¶æ®µç»“æŸåŽç”¨$EMA_{weights}$æ›¿æ¢æ¨¡åž‹æƒé‡è¿›è¡Œé¢„æµ‹ã€‚
>
> å…·ä½“åœ°ï¼ŒEMAçš„è¶…å‚decayä¸€èˆ¬è®¾ä¸ºæŽ¥è¿‘1çš„æ•°ï¼Œä»Žè€Œä¿è¯æ¯æ¬¡$EMA_{weights}$çš„æ›´æ–°éƒ½å¾ˆç¨³å®šã€‚æ¯batchæ›´æ–°æµç¨‹ä¸ºï¼š
> $$
> Weights=Weights+LR*Grad
> $$
> ï¼ˆæ¨¡åž‹æ­£å¸¸çš„æ¢¯åº¦ä¸‹é™ï¼‰
> $$
> EMA_{weights}=EMA_{weights}*decay+(1-decay)*Weights
> $$
>
> ï¼ˆæ ¹æ®æ–°$weight$æ›´æ–°$EMA_{weights}$ï¼‰
>
> éœ€è¦çŸ¥é“è®­ç»ƒé˜¶æ®µæ— å…³$EMA_{weights}$ï¼Œå®ƒåªåœ¨æµ‹è¯•é˜¶æ®µæ—¶å¯¼å…¥è¿›è¡Œé¢„æµ‹ã€‚

### 3.6.2 éšæœºåŠ æƒå¹³å‡ Stochastic Weight Averaging

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091328131-1335870009.png)

> éšæœºåŠ æƒå¹³å‡å’Œå¿«é€Ÿå‡ ä½•é›†æˆéžå¸¸è¿‘ä¼¼ï¼Œé™¤äº†è®¡ç®—æŸå¤±çš„éƒ¨åˆ†ã€‚ SWA å¯ä»¥åº”ç”¨äºŽä»»ä½•æž¶æž„å’Œæ•°æ®é›†ï¼Œè€Œä¸”éƒ½èƒ½äº§ç”Ÿè¾ƒå¥½çš„ç»“æžœã€‚
> SGDå€¾å‘äºŽæ”¶æ•›åˆ°lossçš„å¹³ç¨³åŒºåŸŸï¼Œç”±äºŽæƒé‡ç©ºé—´çš„ç»´åº¦æ¯”è¾ƒé«˜ï¼Œå¹³ç¨³åŒºåŸŸçš„å¤§éƒ¨åˆ†éƒ½å¤„äºŽè¾¹ç•Œï¼ŒSGDé€šå¸¸åªä¼šèµ°åˆ°è¿™äº›å¹³ç¨³åŒºåŸŸçš„è¾¹ç•Œã€‚SWAé€šè¿‡å¹³å‡å¤šä¸ªSGDçš„æƒé‡å‚æ•°ï¼Œä½¿å…¶èƒ½å¤Ÿè¾¾åˆ°å¹³ç¨³åŒºåŸŸçš„ä¸­å¿ƒã€‚


## 3.7 æ•°æ®å¢žå¼º

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091348846-1593270578.png)


### 3.7.1 æ•°æ®å¢žå¼º Data Augmentation

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091402271-1620850296.png)

> - è®­ç»ƒæ³›åŒ–æ€§å¥½çš„æ¨¡åž‹ï¼Œéœ€è¦å¤§é‡å¤šæ ·åŒ–çš„æ•°æ®ï¼Œ
>   è€Œæ•°æ®çš„é‡‡é›†æ ‡æ³¨æ˜¯æœ‰æˆæœ¬çš„ã€‚
> - å›¾åƒå¯ä»¥é€šè¿‡ç®€å•çš„å˜æ¢äº§ç”Ÿä¸€ç³»åˆ—"å‰¯æœ¬"ï¼Œæ‰©
>   å……è®­ç»ƒæ•°æ®é›†ã€‚
> - æ•°æ®å¢žå¼ºæ“ä½œå¯ä»¥ç»„åˆï¼Œç”Ÿæˆå˜åŒ–æ›´å¤æ‚çš„å›¾åƒ

### 3.7.2 ç»„åˆæ•°æ®å¢žå¼º AutoAugment & RandAugment

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091414343-1156181832.png)

> æ—¢ç„¶æ•°æ®å¢žå¼ºæ‰‹æ®µèƒ½å¤Ÿæé«˜æ¨¡åž‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‡ªç„¶å¸Œæœ›é€šè¿‡ä¸€ç³»åˆ—æ•°æ®å¢žå¼ºçš„ç»„åˆèŽ·å¾—æœ€ä¼˜çš„æ³›åŒ–æ•ˆæžœï¼Œä»Žè€Œè¡ç”Ÿå‡ºäº†ä¸€ç³»åˆ—ç»„åˆå¢žå¼ºæ‰‹æ®µã€‚
> è¿™é‡Œæˆ‘ä»¬ä»‹ç»å…¶ä¸­æœ€è‘—åä¹Ÿæœ€å¸¸ç”¨çš„ä¸¤ä¸ªæ‰‹æ®µï¼Œ**AutoAugment**å’Œ**RandAugment**ã€‚
>
> - **AutoAugment**
>
>   [AutoAugment: Learning Augmentation Policies from Data](https://arxiv.org/abs/1805.09501)
>
>   AutoAugment æå‡ºäº†ä¸€ä¸ªå…·æœ‰è¾ƒå¼ºå¯æ“ä½œæ€§çš„æ•°æ®å¢žå¼ºç»„åˆæœç´¢æ–¹æ³•ã€‚
>
>   - 1.ä½¿ç”¨ä¸€ä¸ª RNN ç½‘ç»œå¯¹æ•°æ®å¢žå¼ºç©ºé—´è¿›è¡Œé‡‡æ ·ï¼Œä¹Ÿå°±æ˜¯é€‰æ‹©ä¸€ç»„æ•°æ®å¢žå¼ºç­–ç•¥å’Œç›¸åº”çš„å‚æ•°ã€‚æ¯ç»„æ–¹æ³•åŒ…å« 5 ä¸ªå­ç­–ç•¥ç»„ï¼Œæ¯ä¸ªå­ç­–ç•¥ç»„åŒ…å«è¿žç»­çš„ä¸¤ä¸ªæ•°æ®å¢žå¼ºæ–¹æ³•ã€‚
>   - 2.ä½¿ç”¨è¿™ä¸€ç»„æ•°æ®å¢žå¼ºç­–ç•¥è®­ç»ƒæŸä¸€ä¸ªå›ºå®šç»“æž„çš„ç¥žç»ç½‘ç»œï¼Œè¿›è€Œå¾—åˆ°å…¶å¯¹è®­ç»ƒç²¾åº¦çš„å¢žç›Šã€‚
>   - 3.å°†è¯¥å¢žç›Šä½œä¸ºå¼ºåŒ–å­¦ä¹ çš„ rewardï¼Œä»Žè€Œä½¿ç”¨ Proximal Policy Optimizationï¼ˆPPOï¼‰å¼ºåŒ–å­¦ä¹ ç®—æ³•å¯¹ç”¨äºŽé‡‡æ ·çš„ RNN ç¥žç»ç½‘ç»œè¿›è¡Œä¼˜åŒ–ã€‚
>   - 4.å­¦ä¹ å®ŒæˆåŽï¼Œé€‰æ‹©æ•ˆæžœæœ€å¥½çš„ 5 ç»„ç­–ç•¥ï¼Œå…±è®¡ 25 ä¸ªå­ç­–ç•¥ç»„ï¼Œç»¼åˆè€Œæˆæœ€åŽçš„æ•°æ®å¢žå¼ºæ‰‹æ®µã€‚
>     åœ¨å®žé™…ä½¿ç”¨æ—¶ï¼Œå¯¹æ¯å¼ å›¾ç‰‡ï¼Œéƒ½ä¼šéšæœºåº”ç”¨è¿™ 25 ä¸ªå­ç­–ç•¥ç»„ä¸­çš„ä¸€ç»„å­ç­–ç•¥è¿›è¡Œå¤„ç†ã€‚
>
> - **RandAugment**
>
>   [RandAugment: Practical automated data augmentation with a reduced search space](https://arxiv.org/abs/1909.13719)
>   å…·ä½“è€Œè¨€ï¼Œ RandAugment è®¾ç½®äº†ä¸€ä¸ªåŒ…å«å„ç§æ•°æ®å¢žå¼ºå˜æ¢çš„é›†åˆï¼Œå¯¹æ¯å¼ å›¾ç‰‡ï¼Œéšæœºåº”ç”¨ K ä¸ªæ•°æ®å¢žå¼ºå˜æ¢ï¼Œæ¯ä¸ªå˜æ¢çš„å¹…åº¦éƒ½æ˜¯é¢„å…ˆè®¾å®šçš„å¹…åº¦ï¼ˆæˆ–è€…åœ¨é¢„è®¾å¹…åº¦çš„åŸºç¡€ä¸Šæ·»åŠ ä¸€ä¸ªéšæœºæµ®åŠ¨ï¼‰ã€‚

### 3.7.3 ç»„åˆå›¾åƒ Mixup & CutMix

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091434759-1413905904.png)

> - **Mixup**
>   [mixup: Beyond Empirical Risk Minimization]([https://arxiv.org/abs/1710.09412](https://arxiv.org/abs/1710.09412?spm=a2c6h.12873639.article-detail.9.66a83e70tpY6CV&file=1710.09412))
>
>   åœ¨ç›‘ç£å­¦ä¹ ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥å‡è®¾æ ·æœ¬ä¸ºéšæœºå˜é‡ Xï¼Œæ ‡ç­¾ä¸ºéšæœºå˜é‡ Yï¼Œæˆ‘ä»¬å¸Œæœ›åšçš„æ˜¯æ ¹æ® X-Y è”åˆåˆ†å¸ƒï¼Œä¼˜åŒ–å‡ºä¸€ä¸ªæœ€ä½³çš„ f(x)ã€‚ä½†çŽ°å®žä¸­ï¼Œæˆ‘ä»¬æ ¹æœ¬æ— æ³•èŽ·å¾— X-Y çš„è”åˆåˆ†å¸ƒï¼Œå…·ä½“åˆ°åˆ†ç±»ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ— æ³•ç©·å°½åƒç´ çš„ç»„åˆä¸Žæ ‡ç­¾ä¹‹é—´çš„å…³ç³»ï¼Œå› è€Œåªèƒ½ç”¨ä¸€ç³»åˆ—æ ·æœ¬æ¥æ‹Ÿåˆè¿™ä¸€è”åˆåˆ†å¸ƒã€‚
>
>   Mixup è¿™ä¸€å¢žå¼ºæ‰‹æ®µçš„ç›®çš„ï¼Œä¹Ÿå³åœ¨äºŽä¼˜åŒ– â€œç”¨æ ·æœ¬æ‹Ÿåˆè”åˆåˆ†å¸ƒâ€ è¿™ä¸€æ­¥ã€‚**å®ƒé‡‡ç”¨äº†ä¸€ä¸ªååˆ†ç®€å•çš„æ“ä½œ**ï¼Œå°†ä¸¤å¼ å›¾ç‰‡ç›´æŽ¥è¿›è¡Œçº¿æ€§ç»„åˆï¼Œå¯¹åº”çš„ï¼Œæ ‡ç­¾ä¹Ÿè¿›è¡Œçº¿æ€§ç»„åˆã€‚å…¶ä¸­ï¼Œå åŠ åœ¨èƒŒæ™¯å›¾ç‰‡ä¸Šçš„å›¾ç‰‡å¼ºåº¦æŒ‰ç…§ Betaï¼ˆaï¼Œaï¼‰åˆ†å¸ƒéšæœºé‡‡æ ·èŽ·å¾—ï¼Œa ä¸ºè¶…å‚æ•°ã€‚
>
> - **CutMix**
>
>   åŽŸè®ºæ–‡ï¼š[CutMix: Regularization Strategy to Train Strong Classifiers with Localizable Features](https://arxiv.org/abs/1905.04899?context=cs.CV)
>
>   CutMix å’Œ Mixup çš„æ€è·¯ä¸€è‡´ï¼Œå…¶**ç›®çš„éƒ½æ˜¯ä¸ºäº†ä¼˜åŒ–â€œç”¨æ ·æœ¬æ‹Ÿåˆè”åˆåˆ†å¸ƒâ€çš„æ–¹æ³•ã€‚**ä½† CutMix çš„ä½œè€…è®¤ä¸ºï¼Œç®€å•åœ°å°†ä¸¤å¼ å›¾ç‰‡å åŠ æ˜¯ä¸è‡ªç„¶çš„ï¼Œå¯¹äºŽåˆ†ç±»ä»»åŠ¡è™½ç„¶æœ‰ä¸€å®šçš„æ•ˆæžœæå‡ï¼Œä½†å¯¹æ£€æµ‹ç­‰ä¸‹æ¸¸ä»»åŠ¡ï¼Œéƒ½ä¼šå¯¼è‡´æ€§èƒ½çš„ä¸‹é™ã€‚
>
>   **CutMix ä¸Ž Mixup çš„ä¸åŒä¹‹å¤„åœ¨äºŽ**ï¼ŒCutMix é€šè¿‡è£å–ä¸€å¼ å›¾ç‰‡ä¸­çš„éƒ¨åˆ†åŒºåŸŸï¼Œä»¥ç±»ä¼¼æ‹¼è´´ç”»çš„æ–¹å¼è´´åˆ°å¦ä¸€å¼ å›¾ç‰‡ä¸Šï¼Œæ¥å®žçŽ°å›¾ç‰‡çš„æ··åˆã€‚å…¶ä¸­ï¼Œè£åˆ‡å›¾ç‰‡çš„é¢ç§¯æ¯”ä¾‹æŒ‰ç…§ Betaï¼ˆaï¼Œaï¼‰åˆ†å¸ƒéšæœºé‡‡æ ·èŽ·å¾—ï¼Œa ä¸ºè¶…å‚æ•°ã€‚

### 3.7.4 æ ‡ç­¾å¹³æ»‘ Label Smoothing

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091449761-542890848.png)

> åœ¨è¿›è¡Œå¤šåˆ†ç±»æ—¶ï¼Œå¾ˆå¤šæ—¶å€™é‡‡ç”¨one-hotæ ‡ç­¾è¿›è¡Œè®¡ç®—äº¤å‰ç†µæŸå¤±ï¼Œè€Œå•çº¯çš„äº¤å‰ç†µæŸå¤±æ—¶ï¼Œåªè€ƒè™‘åˆ°äº†æ­£ç¡®æ ‡ç­¾çš„ä½ç½®çš„æŸå¤±ï¼Œè€Œå¿½ç•¥äº†é”™è¯¯æ ‡ç­¾ä½ç½®çš„æŸå¤±ã€‚è¿™æ ·å¯¼è‡´æ¨¡åž‹å¯èƒ½ä¼šåœ¨è®­ç»ƒé›†ä¸Šæ‹Ÿåˆçš„éžå¸¸å¥½ï¼Œä½†ç”±äºŽå…¶é”™è¯¯æ ‡ç­¾ä½ç½®çš„æŸå¤±æ²¡æœ‰è®¡ç®—ï¼Œå¯¼è‡´é¢„æµ‹çš„æ—¶å€™ï¼Œé¢„æµ‹é”™è¯¯çš„æ¦‚çŽ‡æ¯”è¾ƒå¤§ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„è¿‡æ‹Ÿåˆã€‚
> **æ ‡ç­¾å¹³æ»‘å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢è¿‡æ‹Ÿåˆã€‚**

## 3.8 æ¨¡åž‹ç›¸å…³ç­–ç•¥

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091509147-1414659344.png)

### 3.8.1 ä¸¢å¼ƒå±‚ Dropout

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091527190-42860979.png)

> - ç¥žç»ç½‘ç»œåœ¨è®­ç»ƒæ—¶ä¼šå‡ºçŽ°å…±é€‚åº”çŽ°è±¡ (co-adaption)ï¼Œç¥žç»å…ƒä¹‹é—´äº§ç”Ÿé«˜åº¦å…³è”ï¼Œå¯¼è‡´è¿‡æ‹Ÿåˆ
> - è®­ç»ƒæ—¶éšæœºä¸¢å¼ƒä¸€äº›è¿žæŽ¥ï¼Œç ´åç¥žç»å…ƒä¹‹é—´çš„å…³è”ï¼Œé¼“åŠ±å­¦ä¹ ç‹¬ç«‹çš„ç‰¹å¾
> - æŽ¨ç†æ—¶ä½¿ç”¨å…¨éƒ¨è¿žæŽ¥
> - å¸¸ç”¨äºŽå…¨è¿žæŽ¥å±‚ï¼Œé€šå¸¸ä¸ä¸Ž BN æ··ç”¨


### 3.8.2 éšæœºæ·±åº¦ Stochastic Depth

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091536044-532049923.png)

> - è®­ç»ƒResNetç½‘ç»œæ—¶ï¼ŒåŠ å…¥äº†éšæœºå˜é‡ bï¼ˆä¼¯åŠªåˆ©éšæœºå˜é‡ï¼Œåªèƒ½å– 0/1ï¼Œå– 0 çš„æ¦‚çŽ‡æ˜¯ 1âˆ’pï¼Œå– 1 çš„
>   æ¦‚çŽ‡æ˜¯ pï¼‰ï¼Œå¯¹æ•´ä¸ª ResBlock å·ç§¯éƒ¨åˆ†åšäº†éšæœºä¸¢å¼ƒã€‚
>
>   - å¦‚æžœ b = 1ï¼Œåˆ™ç®€åŒ–ä¸ºåŽŸå§‹çš„ ResNet ç»“æž„ï¼›
>   - å¦‚æžœ b = 0ï¼Œåˆ™è¿™ä¸ª ResBlock æœªè¢«æ¿€æ´»ï¼Œé™ä¸ºæ’ç­‰å‡½æ•°ã€‚
>
>   $$
>   H_{l} = ReLU(b_{l}f_{l}H_{l-1}) + id(H_{l-1})
>   $$
>
> - åˆ©ç”¨ä¸åŒçš„æ·±åº¦è®­ç»ƒï¼Œæœ€ç»ˆç›¸å½“äºŽæ½œåœ¨åœ°èžåˆäº†å¤šä¸ªä¸åŒæ·±åº¦çš„ç½‘ç»œï¼Œæå‡äº†æ€§èƒ½ã€‚


## 3.9 è‡ªç›‘ç£å­¦ä¹ 

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091551923-919681291.png)

### 3.9.1 è‡ªç›‘ç£å­¦ä¹ çš„å¸¸è§ç±»åž‹

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091611877-1372229416.png)

> è‡ªç›‘ç£å­¦ä¹ ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§å¸¸è§ç±»åž‹ï¼š
>
> - åŸºäºŽ**ä»£ç†ä»»åŠ¡**
> - åŸºäºŽ**å¯¹æ¯”å­¦ä¹ **
> - åŸºäºŽ**æŽ©ç å­¦ä¹ **

### 3.9.2 è‡ªç›‘ç£å­¦ä¹ çš„åº”ç”¨

#### 3.9.2.1 Relative Location (ICCV 2015)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091645330-1686627030.png)

> **Relative Locationçš„åŸºæœ¬å‡è®¾**ï¼šæ¨¡åž‹åªæœ‰å¾ˆå¥½åœ°ç†è§£åˆ°å›¾ç‰‡å†…å®¹ï¼Œæ‰èƒ½å¤Ÿé¢„æµ‹å›¾åƒå—ä¹‹é—´çš„å…³ç³»

#### 3.9.2.2 SimCLR (ICML 2020)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091659477-1799295357.png)

> **SimCLRçš„åŸºæœ¬å‡è®¾**ï¼šå¦‚æžœæ¨¡åž‹èƒ½å¾ˆå¥½åœ°æå–å›¾ç‰‡å†…å®¹çš„æœ¬è´¨ï¼Œé‚£ä¹ˆæ— è®ºå›¾ç‰‡ç»è¿‡ä»€ä¹ˆæ ·çš„æ•°æ®å¢žå¼ºæ“ä½œï¼Œæå–å‡ºæ¥çš„ç‰¹å¾éƒ½åº”è¯¥æžä¸ºç›¸ä¼¼ã€‚
>
> - SimCLRå‘çŽ°äº†ï¼š
>   - æ•°æ®æ‰©å……çš„ç»„åˆåœ¨æœ‰æ•ˆçš„é¢„æµ‹ä»»åŠ¡ä¸­èµ·ç€å…³é”®ä½œç”¨ï¼›
>   - åœ¨è¡¨å¾å’Œå¯¹æ¯”æŸå¤±ä¹‹é—´å¼•å…¥å¯å­¦ä¹ çš„éžçº¿æ€§å˜æ¢ï¼Œå¤§å¤§æé«˜äº†å­¦ä¹ è¡¨ç¤ºçš„è´¨é‡ï¼›
>   - ä¸Žæœ‰ç›‘ç£çš„å­¦ä¹ ç›¸æ¯”ï¼Œå¯¹æ¯”å­¦ä¹ éœ€è¦æ›´å¤§batch sizeå’Œè®­ç»ƒè½®æ•°ã€‚

#### 3.9.2.3 Masked autoencoders (MAE, CVPR 2022)

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091718677-876378056.png)

> - **MAEçš„åŸºæœ¬å‡è®¾**ï¼šæ¨¡åž‹åªæœ‰ç†è§£å›¾ç‰‡å†…å®¹ã€æŽŒæ¡å›¾ç‰‡çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæ‰èƒ½æ¢å¤å‡ºå›¾ç‰‡ä¸­è¢«éšæœºé®æŒ¡çš„å†…å®¹ã€‚
>
> æœ¬æ–‡è¡¨æ˜Žï¼ŒæŽ©ç è‡ªåŠ¨ç¼–ç å™¨ (MAE) æ˜¯ç”¨äºŽè®¡ç®—æœºè§†è§‰çš„å¯æ‰©å±•è‡ªç›‘ç£å­¦ä¹ å™¨ã€‚æˆ‘ä»¬çš„ MAE æ–¹æ³•å¾ˆç®€å•ï¼šæˆ‘ä»¬å±è”½è¾“å…¥å›¾åƒçš„éšæœºè¡¥ä¸å¹¶é‡å»ºä¸¢å¤±çš„åƒç´ ã€‚å®ƒåŸºäºŽä¸¤ä¸ªæ ¸å¿ƒè®¾è®¡ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªéžå¯¹ç§°ç¼–ç å™¨-è§£ç å™¨æž¶æž„ï¼Œå…¶ä¸­ä¸€ä¸ªç¼–ç å™¨ä»…å¯¹å¯è§çš„è¡¥ä¸å­é›†ï¼ˆæ²¡æœ‰æŽ©ç æ ‡è®°ï¼‰è¿›è¡Œæ“ä½œï¼Œä»¥åŠä¸€ä¸ªè½»é‡çº§è§£ç å™¨ï¼Œè¯¥è§£ç å™¨ä»Žæ½œåœ¨è¡¨ç¤ºå’ŒæŽ©ç æ ‡è®°ä¸­é‡å»ºåŽŸå§‹å›¾åƒã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬å‘çŽ°å±è”½å¤§éƒ¨åˆ†è¾“å…¥å›¾åƒï¼ˆä¾‹å¦‚ 75%ï¼‰ä¼šäº§ç”Ÿé‡è¦ä¸”æœ‰æ„ä¹‰çš„è‡ªæˆ‘ç›‘ç£ä»»åŠ¡ã€‚ç»“åˆè¿™ä¸¤ç§è®¾è®¡ä½¿æˆ‘ä»¬èƒ½å¤Ÿé«˜æ•ˆä¸”æœ‰æ•ˆåœ°è®­ç»ƒå¤§åž‹æ¨¡åž‹ï¼šæˆ‘ä»¬åŠ é€Ÿè®­ç»ƒï¼ˆ3 å€æˆ–æ›´å¤šï¼‰å¹¶æé«˜å‡†ç¡®æ€§ã€‚æˆ‘ä»¬çš„å¯æ‰©å±•æ–¹æ³•å…è®¸å­¦ä¹ å…·æœ‰è‰¯å¥½æ³›åŒ–èƒ½åŠ›çš„é«˜å®¹é‡æ¨¡åž‹ï¼šä¾‹å¦‚ï¼Œåœ¨ä»…ä½¿ç”¨ ImageNet-1K æ•°æ®çš„æ–¹æ³•ä¸­ï¼Œvanilla ViT-Huge æ¨¡åž‹å®žçŽ°äº†æœ€ä½³å‡†ç¡®åº¦ (87.8%)ã€‚ä¸‹æ¸¸ä»»åŠ¡ä¸­çš„è¿ç§»æ€§èƒ½ä¼˜äºŽæœ‰ç›‘ç£çš„é¢„è®­ç»ƒï¼Œå¹¶æ˜¾ç¤ºå‡ºæœ‰å‰é€”çš„ç¼©æ”¾è¡Œä¸ºã€‚

## 3.10 æ€»ç»“

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091732335-1673186302.png)




# 4.MMClassification

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091809259-185559749.png)

## 4.1 MMClassification ä»‹ç»

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204091828763-1644804973.png)

> MMClassification æ˜¯ä¸€æ¬¾åŸºäºŽPyTorch çš„å¼€æºå›¾åƒåˆ†ç±»å·¥å…·ç®±, é›†æˆäº†å¸¸ç”¨çš„å›¾åƒåˆ†ç±»ç½‘ç»œï¼Œå°†æ•°æ®åŠ è½½ï¼Œæ¨¡åž‹éª¨æž¶ï¼Œè®­ç»ƒè°ƒå‚ï¼Œæµç¨‹ç­‰å°è£…ä¸ºæ¨¡å—è°ƒç”¨ï¼Œä¾¿äºŽåœ¨æ¨¡åž‹é—´è¿›è¡Œè½¬æ¢å’Œæ¯”è¾ƒï¼Œä¹Ÿé«˜æ•ˆç®€æ´çš„å®žçŽ°äº†å‚æ•°è°ƒæ•´ã€‚

## 4.2 Python æŽ¨ç† API

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092023206-412635423.png)

### 4.2.1 ä¸‹è½½é…ç½®æ–‡ä»¶å’Œä¸Žè®­ç»ƒæƒé‡

```shell
# ä¸‹è½½é…ç½®æ–‡ä»¶å’Œä¸Žè®­ç»ƒæƒé‡
$ mim download mmcls --config mobilenet-v2_8xb32_in1k --dest .
```

### 4.2.2 ä½¿ç”¨Python API æŽ¨ç†

```python
# ä½¿ç”¨Python API æŽ¨ç†
from mmcls.apis import init_model, inference_model, show_result_pyplot
model = init_model('mobilenet-v2_8xb32_in1k.py',
'mobilenet_v2_batch256_imagenet_20200708-3b2dc3af.pth',
device='cuda:0')
result = inference_model(model, 'banana.png')
show_result_pyplot(model, 'banana.png', result)
```

```python
# æŽ¨ç†ç»“æžœresult
{'pred_class': 'bananaâ€™, 
'pred_label': 954, 
'pred_score': 0.9999284744262695}
```


## 4.3 æŽ¨ç†å·¥å…·ï¼ˆéœ€æºç å®‰è£…ï¼‰

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092038123-1211872153.png)

### 4.3.1 å•å¼ å›¾åƒæŽ¨ç†

```shell
# å•å¼ å›¾åƒæŽ¨ç†
python demo/image_demo.py ${IMAGE_FILE} ${CONFIG_FILE} ${CHECKPOINT_FILE}
```

### 4.3.2 åœ¨æµ‹è¯•é›†ä¸Šæµ‹è¯•

```shell
# åœ¨æµ‹è¯•é›†ä¸Šæµ‹è¯•
python tools/test.py ${CONFIG_FILE} ${CHECKPOINT_FILE} [--metrics ${METRICS}] [--out 
${RESULT_FILE}]
```



```shell
# å¤šæœºå¤šå¡
./tools/dist_test.sh ${CONFIG_FILE} ${CHECKPOINT_FILE} ${GPU_NUM} [--metrics ${METRICS}] [--out 
${RESULT_FILE}]
```

- ä½¿ç”¨è¯´æ˜Žï¼šhttps://mmclassification.readthedocs.io/en/latest/getting_started.html#inference-asingle-image

## 4.4 è®­ç»ƒå·¥å…·ï¼ˆéœ€æºç å®‰è£…ï¼‰

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092059737-1808213694.png)

### 4.4.1 å•å¡è®­ç»ƒ


```shell
# å•å¡è®­ç»ƒ
python tools/train.py ${CONFIG_FILE} [optional arguments]
```

### 4.4.2 å•æœºã€å¤šæœºå¤šå¡è®­ç»ƒ

```shell
# å•æœºã€å¤šæœºå¤šå¡è®­ç»ƒ
./tools/dist_train.sh ${CONFIG_FILE} ${GPU_NUM} [optional arguments]
```
### 4.4.3 ä½¿ç”¨ä»»åŠ¡è°ƒåº¦å™¨ Slurm å¯åŠ¨ä»»åŠ¡
```shell
# ä½¿ç”¨ä»»åŠ¡è°ƒåº¦å™¨ Slurm å¯åŠ¨ä»»åŠ¡
[GPUS=${GPUS}] ./tools/slurm_train.sh ${PARTITION} ${JOB_NAME} ${CONFIG_FILE} ${WORK_DIR}
```

```shell
# ä»Ž checkpoint æ¢å¤è®­ç»ƒ
å¢žåŠ  --resume-from ${CHECKPOINT_FILE} å‚æ•°
```

- ä½¿ç”¨è¯´æ˜Žï¼šhttps://mmclassification.readthedocs.io/en/latest/getting_started.html#train-a-model

## 4.5 ä½¿ç”¨ MIM å·¥å…·å®žçŽ°è®­ç»ƒå’Œæµ‹è¯•

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092110377-616067250.png)

### 4.5.1 ä¸‹è½½é…ç½®æ–‡ä»¶å’Œé¢„è®­ç»ƒæƒé‡

```shell
mim download mmcls --config mobilenet-v2_8xb32_in1k --dest . 
```

### 4.5.2 è®­ç»ƒï¼ˆæ”¯æŒå•å¡ã€å¤šå¡ã€Slurm ä»»åŠ¡ç®¡ç†å™¨ï¼‰

```shell
mim train mmcls {å‚æ•°åŒ mmcls è‡ªå·±çš„ train.py}
mim train mmcls {å‚æ•°åŒ mmcls è‡ªå·±çš„ train.py} -G 4 â€“g 4 â€“p ${PARTITION} --launcher slurm
```

### 4.5.3 æµ‹è¯•

```shell
mim test mmcls {å‚æ•°åŒ mmcls è‡ªå·±çš„ test.py} --gpus 4 --launcher pytorch
```

- ä½¿ç”¨è¯´æ˜Žï¼šhttps://github.com/open-mmlab/mim


## 4.6 çŽ¯å¢ƒæ­å»º

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092119654-305998715.png)

> - MIMï¼šhttps://github.com/open-mmlab/mim
> - MMClsï¼šhttps://github.com/open-mmlab/mmclassification
> - MMDetï¼šhttps://github.com/open-mmlab/mmdetection
> - MMCVï¼šhttps://github.com/open-mmlab/mmcv


## 4.7 OpenMMLab é¡¹ç›®ä¸­çš„é‡è¦æ¦‚å¿µâ€”â€”é…ç½®æ–‡ä»¶

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092132149-1242270789.png)

> æ·±åº¦å­¦ä¹ æ¨¡åž‹çš„è®­ç»ƒæ¶‰åŠå‡ ä¸ªæ–¹é¢ï¼š
>
> - æ¨¡åž‹ç»“æž„
> - æ•°æ®é›†
> - è®­ç»ƒç­–ç•¥
> - è¿è¡Œæ—¶
> - ä¸€äº›è¾…åŠ©åŠŸèƒ½

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204191429829-1038510408.png)

> åœ¨ OpenMMLab é¡¹ç›®ä¸­ï¼Œæ‰€æœ‰è¿™äº›é¡¹ç›®éƒ½æ¶µç›–åœ¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼Œä¸€ä¸ªé…ç½®æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªå®Œæ•´çš„è®­ç»ƒ
> è¿‡ç¨‹
>
> - model å­—æ®µå®šä¹‰æ¨¡åž‹
> - data å­—æ®µå®šä¹‰æ•°æ® 
> - optimizerã€lr_config ç­‰å­—æ®µå®šä¹‰è®­ç»ƒç­–ç•¥
> - load_from å­—æ®µå®šä¹‰ä¸Žè®­ç»ƒæ¨¡åž‹çš„å‚æ•°æ–‡ä»¶
>
> config/metafile.yml
> ![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204201452544-1136962682.png)


## 4.8 é…ç½®æ–‡ä»¶çš„è¿ä½œæ–¹å¼

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092200855-1094163448.png)

> - é…ç½®æ–‡ä»¶
> - æ¨¡åž‹åº“
> - æ•°æ®æ–‡ä»¶
>   â€”â€”> å†…éƒ¨æ¨¡å—â€”â€”>å·¥å…·


## 4.9 å›¾åƒåˆ†ç±»æ¨¡åž‹çš„æž„æˆ

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092235171-1071333586.png)

> åœ¨MMClassificationä¸­ï¼Œå¯¹äºŽå›¾åƒåˆ†ç±»æ¨¡åž‹çš„æž„æˆï¼Œä¸»è¦åŒ…å«**éª¨å¹²ç½‘ç»œ(backbone)**ã€**é¢ˆéƒ¨(neck)**ä»¥åŠ**å¤´éƒ¨(head)**ã€‚

## 4.10 å›¾åƒåˆ†ç±»æ¨¡åž‹æž„å»º

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092250161-1938569788.png)

> åŒæ—¶ï¼Œåˆ†åˆ«é’ˆå¯¹ä¸»å¹²ç½‘ç»œã€é¢ˆéƒ¨å’Œåˆ†ç±»å¤´ï¼Œå¯ä»¥è¿›è¡Œç›¸åº”çš„é…ç½®ï¼Œä»Žè€Œæž„å»ºå›¾åƒåˆ†ç±»ç½‘ç»œæ¨¡åž‹ã€‚

## 4.11 æ•°æ®é›†æž„å»º

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092303251-510510309.png)

> å…³äºŽæ•°æ®é›†ï¼Œè¿™é‡Œä¸»è¦å…³æ³¨çš„æ˜¯æ•°æ®é›†æ˜¯å¦‚ä½•åŠ è½½å’Œé…ç½®çš„ï¼Œå¯ä»¥é€šè¿‡å‚æ•°è¿›è¡Œè®¾ç½®ã€‚

## 4.12 å®šä¹‰æ•°æ®åŠ è½½æµæ°´çº¿

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092320069-112116681.png)

>  **data load pipeline**
> è¿™é‡Œçš„æ•°æ®åŠ è½½æµæ°´çº¿ï¼Œå¯ä»¥æ ¹æ®è®­ç»ƒæˆ–å…¶ä»–å®žé™…çš„éœ€è¦ï¼Œè¿›è¡Œæ•°æ®å¢žå¼ºå’Œå½’ä¸€åŒ–åŠè½¬æ¢Tensorç­‰ç›¸å…³å¤„ç†ã€‚

## 4.13 é…ç½®å­¦ä¹ ç­–ç•¥

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092341933-1614495311.png)

> ç½‘ç»œæ¨¡åž‹å®šä¹‰å®Œæˆï¼Œæ•°æ®é›†æž„å»ºå¹¶ä¼ å…¥æµæ°´çº¿ä¸­åŽï¼Œéœ€è¦è¿›è¡Œç›¸åº”çš„å­¦ä¹ ç­–ç•¥è®¾ç½®ã€‚
>
> - optimizerï¼šä¼˜åŒ–å™¨é…ç½®
> - lr_configï¼šå­¦ä¹ çŽ‡ç­–ç•¥
> - runnerï¼šè¿è¡Œå™¨Runner


## 4.14 é¢„è®­ç»ƒæ¨¡åž‹åº“

![](https://img2023.cnblogs.com/blog/1571518/202302/1571518-20230204092353640-28506269.png)

> å¦‚æžœéœ€è¦åŸºäºŽé¢„è®­ç»ƒæ¨¡åž‹è¿›è¡Œè¿ç§»å­¦ä¹ çš„è®­ç»ƒï¼Œå¯ä»¥åŽ»å¯¹åº”çš„Model ZOOé‡Œé¢ä¸‹è½½ã€‚

# 5.å‚è€ƒææ–™

[1] OpenMMLab AIå®žæˆ˜è¥è¯¾ä»¶
[2] è¡¥å……å†…å®¹ï¼Œéƒ¨åˆ†æ¥æºäºŽç½‘ç»œææ–™å’Œè®ºæ–‡åˆŠç‰©
